/**
 * Blur Copyright (c) 2008-2015 by Abine, Inc. All Rights Reserved.
 *
 * This software is the confidential and proprietary information
 * of Abine, Inc. ("Confidential Information"), subject
 * to the Non-Disclosure Agreement and/or License Agreement you entered
 * into with Abine. You shall use such Confidential Information only
 * in accordance with the terms of said Agreement(s). Abine makes
 * no representations or warranties about the suitability of the
 * software. The software is provided with ABSOLUTELY NO WARRANTY
 * and Abine will NOT BE LIABLE for ANY DAMAGES resulting from
 * the use of the software.
 *
 * Contact license@getabine.com with any license-related questions.
 *
 * https://www.abine.com
 * @license
 *
 */
ABINE_DNTME.define("abine/timer",[],function(){var e=1,t={},n=function(n,r){var i=e++,a=Cc["@mozilla.org/timer;1"].createInstance(Ci.nsITimer);return t[i]=a,a.initWithCallback(function(){delete t[i],n()},r,Ci.nsITimer.TYPE_ONE_SHOT),i},r=function(e){try{e in t&&(t[e].cancel(),delete t[e])}catch(e){}},i=function(n,r){var i=e++,a=Cc["@mozilla.org/timer;1"].createInstance(Ci.nsITimer);return t[i]=a,a.initWithCallback(n,r,Ci.nsITimer.TYPE_REPEATING_SLACK),i},a={};return"undefined"!=typeof window&&"function"==typeof window.setTimeout?a.setTimeout=function(){return ABINE_DNTME.log,window.setTimeout.apply(window,arguments)}:a.setTimeout=n,"undefined"!=typeof window&&"function"==typeof window.clearTimeout?a.clearTimeout=function(){window.clearTimeout.apply(window,arguments)}:a.clearTimeout=r,"undefined"!=typeof window&&"function"==typeof window.setInterval?a.setInterval=function(){return window.setInterval.apply(window,arguments)}:a.setInterval=i,"undefined"!=typeof window&&"function"==typeof window.clearInterval?a.clearInterval=function(){window.clearInterval.apply(window,arguments)}:a.clearInterval=r,a}),ABINE_DNTME.define("abine/intl",[],function(){function e(a,o){if(a in i)if(a in r)n=BUNDLE[a],t=a,o();else{var s=document.createElement("script");s.setAttribute("src","locales/"+a+".js"),s.addEventListener("load",function(){r[a]=!0,n=BUNDLE[a],t=a,o()}),s.addEventListener("error",function(){e("en",o)}),document.getElementsByTagName("body")[0].appendChild(s)}else e("en",o)}var t=navigator.language.replace(/\-.*/,"").toLowerCase(),n=null,r={en:1},i={en:1,de:1,fr:1,it:1,nl:1,pl:1,pt:1,zh:1};return{setupLocale:e,getLang:function(){return t},getText:function(e,t){t&&"object"!=typeof t&&(t=[t]);var r=null;if(e=e.replace(/\./g,"_"),n)try{r=n[e]||BUNDLE.en[e],r&&t&&(r=r.replace(/\{([0-9]+)\}/g,function(e,n){return t[parseInt(n)]+""}))}catch(e){}return r&&""!=r||(r="***"+e),r}}});/*!
CryptoJS v3.1.2
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
var CryptoJS=CryptoJS||function(e,t){var n={},r=n.lib={},i=r.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var n=new e;return t&&n.mixIn(t),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),a=r.WordArray=i.extend({init:function(e,n){e=this.words=e||[],n!=t?this.sigBytes=n:this.sigBytes=4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var a=0;a<i;a++){var o=n[a>>>2]>>>24-a%4*8&255;t[r+a>>>2]|=o<<24-(r+a)%4*8}else if(n.length>65535)for(var a=0;a<i;a+=4)t[r+a>>>2]=n[a>>>2];else t.push.apply(t,n);return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),o=n.enc={},s=o.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var a=t[i>>>2]>>>24-i%4*8&255;r.push((a>>>4).toString(16)),r.push((15&a).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},l=o.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var a=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(a))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},c=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},u=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,s=4*o,l=i/s;l=t?e.ceil(l):e.max((0|l)-this._minBufferSize,0);var c=l*o,u=e.min(4*c,i);if(c){for(var d=0;d<c;d+=o)this._doProcessBlock(r,d);var h=r.splice(0,c);n.sigBytes-=u}return new a.init(h,u)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),d=(r.Hasher=u.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new d.HMAC.init(e,n).finalize(t)}}}),n.algo={});return n}(Math);/*!
CryptoJS v3.1.2
code.google.com/p/crypto-js
(c) 2009-2013 by Jeff Mott. All rights reserved.
code.google.com/p/crypto-js/wiki/License
*/
!function(){var e=CryptoJS,t=e.lib,n=t.WordArray,r=t.Hasher,i=e.algo,a=[],o=i.SHA1=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],l=n[4],c=0;c<80;c++){if(c<16)a[c]=0|e[t+c];else{var u=a[c-3]^a[c-8]^a[c-14]^a[c-16];a[c]=u<<1|u>>>31}var d=(r<<5|r>>>27)+l+a[c];d+=c<20?(i&o|~i&s)+1518500249:c<40?(i^o^s)+1859775393:c<60?(i&o|i&s|o&s)-1894007588:(i^o^s)-899497514,l=s,s=o,o=i<<30|i>>>2,i=r,r=d}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[(r+64>>>9<<4)+14]=Math.floor(n/4294967296),t[(r+64>>>9<<4)+15]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=r._createHelper(o),e.HmacSHA1=r._createHmacHelper(o)}(),/*!
 CryptoJS v3.1.2
 code.google.com/p/crypto-js
 (c) 2009-2013 by Jeff Mott. All rights reserved.
 code.google.com/p/crypto-js/wiki/License
 */
ABINE_DNTME.define("cryptojs",function(){return{SHA1:function(e){return CryptoJS.SHA1(e).toString()}}}),ABINE_DNTME.define("abine/core",["documentcloud/underscore"],function(e){var t={on:function(e,t,n){var r=this._callbacks||(this._callbacks={}),i=r[e]||(r[e]={}),a=i.tail||(i.tail=i.next={});return a.callback=t,a.context=n,i.tail=a.next={},this},off:function(e,t){var n,r,i;if(e){if(n=this._callbacks)if(t){if(r=n[e])for(;(i=r)&&(r=r.next);)if(r.callback===t){i.next=r.next,r.context=r.callback=null;break}}else n[e]={}}else this._callbacks=null;return this},trigger:function(e){var t,n,r,i,a,o=["all",e];if(!(n=this._callbacks))return this;for(;a=o.pop();)if(t=n[a])for(i="all"==a?arguments:Array.prototype.slice.call(arguments,1);t=t.next;)(r=t.callback)&&r.apply(t.context||this,i);return this},once:function(e,t,n){function r(){return i.off(e,r),t.apply(this,arguments)}var i=this;return this.on(e,r,n)},onceAny:function(){function e(){for(var n=0;n<t.length;n++)this.off.apply(this,[t[n][0],e]),this.off.apply(this,t[n])}for(var t=arguments,n=0;n<arguments.length;n++)this.on.apply(this,arguments[n]),this.on.apply(this,[arguments[n][0],e]);return this},hasListeners:function(e){var t,n;if(!(n=this._callbacks))return!1;if(!(t=n[e]))return!1;for(;t=t.next;)if(t.callback)return!0;return!1}};t.bind=t.on,t.unbind=t.off;var n=function(){},r=function(t,r,i){var a;return a=r&&r.hasOwnProperty("constructor")?r.constructor:function(){return t.apply(this,arguments)},e.extend(a,t),n.prototype=t.prototype,a.prototype=new n,r&&e.extend(a.prototype,r),i&&e.extend(a,i),a.prototype.constructor=a,a.__super__=t.prototype,a},i=function(e,t){var n=r(this,e,t);return n.extend=this.extend,n},a=function(){this.initialize.apply(this,arguments)};return e.extend(a.prototype,t,{initialize:function(){}}),a.extend=i,{BaseClass:a,Events:t}}),ABINE_DNTME.define("abine/simulateEvents",["documentcloud/underscore"],function(){return function(){function e(e,n){var r,o=e.ownerDocument,s=t(a,arguments[2]||{}),l=null;for(var c in i)if(i[c].test(n)){l=c;break}if(!l)throw new SyntaxError("Only HTMLEvents and MouseEvents interfaces are supported");if(o.createEvent)r=o.createEvent(l),"HTMLEvents"==l?r.initEvent(n,s.bubbles,s.cancelable):r.initMouseEvent(n,s.bubbles,s.cancelable,o.defaultView,s.button,s.pointerX,s.pointerY,s.pointerX,s.pointerY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,e),e.dispatchEvent(r);else{s.clientX=s.pointerX,s.clientY=s.pointerY;var u=o.createEventObject();r=t(u,s),e.fireEvent("on"+n,r)}return e}function t(e,t){for(var n in t)e[n]=t[n];return e}function n(){!function(){function e(e,t,n){t=t||{};var r=e.ownerDocument||e,i=r.createEvent?r.createEvent("CustomEvent"):r.createEventObject();i.initCustomEvent&&i.initCustomEvent(t.type,!!t.bubbles,!!t.cancelable,t.detail);for(var a in t)i[a]=t[a];return setTimeout(function(){try{e.dispatchEvent?e.dispatchEvent(i):e.fireEvent("on"+t.type,r.createEventObject())}catch(n){var a=e["listen"+t.type];if(a)for(var o=0;o<a.length;++o)try{a[o].call(e,i)}catch(e){}}n()},0),this}function t(e,t,n){function r(e,t){try{var n=e.ownerDocument;if(n.createEventObject){var r=n.createEventObject();e.fireEvent("on"+t,r)}else r=n.createEvent("HTMLEvents"),r.initEvent(t,!0,!0),e.dispatchEvent(r)}catch(e){}}var i=!0,a=e.className&&e.className.indexOf("fancified")!=-1;if(window.jQuery){var o=window.jQuery(e);try{if(o.selectBoxIt)o.selectBoxIt("selectOption",o.val());else if(o.data("chosen")||o.chosen)o.trigger("chosen:updated").trigger("liszt:updated");else if(o.data("chooserElement"))o.trigger("change");else if(o.fancySelect)o.get("fancySelect").select("value",o.val());else if(o.selectBox)o.selectBox("value",o.val());else if(o.selectric)o.selectric("refresh");else if(o.coreUISelect){var s=o.data("coreUISelect");s.isSelectShow=!0,s.changeDropdownData(),s.isSelectShow=!1}else if(o.data("myJSPulldownObject")){var l=o.data("myJSPulldownObject");l.setToValue(o.val())}else if(o.fancyfields)o.setVal(o.val());else if(o.data("select2"));else if(o.data("selectize"))i=!1,o.data("selectize").setValue(o.val());else if(o.hasClass("fancified"))o.trigger("update");else if(o.selectmenu){var c=o.val();try{o.selectmenu("value",o[0].options[0].value)}catch(e){}o.selectmenu("value",c)}else o.hasClass("select-hidden")&&o.next("div.select-styled").length&&o.next("div.select-styled").next(".select-options").length&&(ulElement=o.next("div.select-styled").next(".select-options"),liElement=ulElement.find("li[rel='"+o.val()+"']"),liElement.click());o.trigger("change")}catch(e){}}i&&(a&&r(e,"update"),r(e,"change"),r(e,"blur")),n()}function n(t,n,r,i){var a=t.value;e(t,{type:"keydown",keyCode:n,which:n,charCode:n,bubbles:!0},function(){e(t,{type:"keypress",keyCode:n,which:n,charCode:n,bubbles:!0},function(){setTimeout(function(){var o=t.value;a==o&&(t.value=r),e(t,{type:"input",keyCode:n,which:n,charCode:n,bubbles:!0},function(){e(t,{type:"keyup",keyCode:n,which:n,charCode:n,bubbles:!0},function(){i()})})},1)})})}function r(e,t,i,a){if(!t||""==t)return void a();var o=t.charCodeAt(0);i+=t.charAt(0),n(e,o,i,function(){r(e,t.substring(1),i,a)})}function i(t,n,r){if(window.abineTriggerChangeInProgress)return void setTimeout(function(){i(t,n,r)},100);var a=!0;window.abineTriggerChangeInProgress=!0;try{if(window.jQuery){var o=window.jQuery(t);o.data("rawMaskFn")||o.mask||o.CardPhoneFormatting?o.focus().val(n).trigger("input").trigger("paste"):o.next(".inner").find(".options").length&&(a=!1,optionsContainer=o.next(".inner").find(".options"),optionElements=optionsContainer.find("span"),optionElements.each(function(){optionElement=$(this),optionElementHtml=$(optionElement).html(),optionElementHtml.toLowerCase().indexOf(n)>-1&&$(optionElement).click()}))}}catch(e){}a?e(t,{type:"change"},function(){e(t,{type:"blur"},function(){try{var e=new Event("input",{bubbles:!0,cancelable:!0});t.dispatchEvent(e)}catch(e){}window.abineTriggerChangeInProgress=!1,r()})}):(window.abineTriggerChangeInProgress=!1,r())}function a(t,n,a){try{t.ownerDocument.defaultView.focus()}catch(e){}e(t,{type:"focus"},function(){e(t,{type:"click"},function(){r(t,n,"",function(){i(t,n,function(){e(document,{type:"abineFilled"},function(){a()})})})})})}function o(n,r,i,a){var o=/[\s]+/g,s=(r||"").toLowerCase().replace(o,""),l=function(){e(document,{type:"abineFilled"},function(){a()})},c=!1,u=!1,d=n.getElementsByTagName("option");if(d&&d.length>0){for(var h=-1,f=0;f<d.length;f++){var p=(d[f].text||"").toLowerCase().replace(o,""),m=(d[f].getAttribute("value")||"").toLowerCase().replace(o,"");if(m==s||p==s){d[f].selected||(c=!0,d[f].selected=!0),u=!0;break}h==-1&&p.indexOf(s)!=-1&&(h=f)}u||h==-1||i||d[h].selected||(c=!0,d[h].selected=!0,u=!0)}n.setAttribute("abineFillResponse",u),c?t(n,r,l):l()}function s(){var e=document.getElementsByClassName("abineFillTarget");if(e.length>0)return e[0];for(var t=0;t<frames.length;t++)try{var e=frames[t].document.getElementsByClassName("abineFillTarget");if(e.length>0)return e[0]}catch(e){}return null}function l(){var n=document.createElement("div");n.id="abineFillElement","undefined"!=typeof paypal&&n.setAttribute("data-paypal","1"),"undefined"!=typeof OffAmazonPayments&&n.setAttribute("data-amazon","1"),"undefined"!=typeof MasterPass&&n.setAttribute("data-masterpass","1"),document.documentElement.appendChild(n),n.addEventListener("fill",function(){var t=s();if(t){var r=n.getAttribute("value");a(t,r,function(){})}else e(document,{type:"abineFilled"},function(){})},!1),n.addEventListener("fillSelect",function(){var t=s();if(t){var r=n.getAttribute("value"),i=!!n.getAttribute("skipPartial");o(t,r,i,function(){})}else e(document,{type:"abineFilled"},function(){})}),n.addEventListener("triggerChange",function(){var e=s(),r=n.getAttribute("value");e&&(e.nodeName.match(/select/i)?t(e,r,function(){}):i(e,r,function(){}))})}l()}()}function r(){return"("+n+")()"}var i={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/},a={pointerX:0,pointerY:0,button:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0,cancelable:!0},o={simulate:e,getAsyncFillString:r};return o}.call(this)}),ABINE_DNTME.define("abine/filler",["documentcloud/underscore","jquery","abine/timer","abine/simulateEvents"],function(e,t,n,r){var i=n.setTimeout;return function(){var n={AF:"Afghanistan",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AC:"Ascension Island",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",BQ:"British Antarctic Territory",IO:"British Indian Ocean Territory",VG:"British Virgin Islands",BN:"Brunei",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",IC:"Canary Islands",CT:"Canton and Enderbury Islands",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",EA:"Ceuta and Melilla",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CP:"Clipperton Island",CC:"Cocos [Keeling] Islands",CO:"Colombia",KM:"Comoros",CD:"Congo [DRC]",CK:"Cook Islands",CR:"Costa Rica",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DG:"Diego Garcia",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",NQ:"Dronning Maud Land",TL:"East Timor",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands [Islas Malvinas]",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",FQ:"French Southern and Antarctic Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Islands",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JT:"Johnston Island",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Laos",LV:"Latvia",LS:"Lesotho",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macau",MK:"Macedonia [FYROM]",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",FX:"Metropolitan France",MX:"Mexico",FM:"Micronesia",MI:"Midway Islands",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NT:"Neutral Zone",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",VD:"North Vietnam",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",QO:"Outlying Oceania",PC:"Pacific Islands Trust Territory",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territories",PA:"Panama",PZ:"Panama Canal Zone",PY:"Paraguay",YD:"People's Democratic Republic of Yemen",PE:"Peru",PH:"Philippines",PN:"Pitcairn Islands",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RO:"Romania",RU:"Russia",RW:"Rwanda",RE:"R&eacute;union",BL:"Saint Barth&eacute;lemy",SH:"Saint Helena",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",CS:"Serbia and Montenegro",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",KR:"South Korea",ES:"Spain",LK:"Sri Lanka",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",ST:"S&atilde;o Tom&eacute; and Pr&iacute;ncipe",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TA:"Tristan da Cunha",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UM:"U.S. Minor Outlying Islands",PU:"U.S. Miscellaneous Pacific Islands",VI:"U.S. Virgin Islands",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:["United States of America","United States"],UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VA:"Vatican City",VE:"Venezuela",VN:"Vietnam",WK:"Wake Island",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",AX:"&Aring;land Islands"},a={AK:"Alaska",AL:"Alabama",AP:"Armed Forces Pacific",AR:"Arkansas",AS:"American Samoa",AZ:"Arizona",CA:"California",CO:"Colorado",CT:"Connecticut",DC:"District of Columbia",DE:"Delaware",FL:"Florida",FM:"Federated States of Micronesia",GA:"Georgia",GU:"Guam",HI:"Hawaii",IA:"Iowa",ID:"Idaho",IL:"Illinois",IN:"Indiana",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",MA:"Massachusetts",MD:"Maryland",ME:"Maine",MH:"Marshall Islands",MI:"Michigan",MN:"Minnesota",MO:"Missouri",MP:"Northern Mariana Islands",MS:"Mississippi",MT:"Montana",NC:"North Carolina",ND:"North Dakota",NE:"Nebraska",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NV:"Nevada",NY:"New York",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",PR:"Puerto Rico",PW:"Palau",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VA:"Virginia",VI:"Virgin Islands",VT:"Vermont",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"},o={1:"US",43:"AT",49:"DE",32:"BE",45:"DK",358:"FI",33:"FR",353:"IE",39:"IT",31:"NL",48:"PL",351:"PT",27:"ZA",34:"ES",46:"SE",44:"GB"},s={"short":"jan,feb,mar,apr,may,jun,jul,aug,sep,oct,nov,dec".split(","),"long":"january,february,march,april,may,june,july,august,september,october,november,december".split(",")},l=/macys\.com|bathandbodyworks\.com/,c=/[\s]+/g,u=function(e,t,n,r){this.document=e,this.domain=t,this.asyncFilling=t&&t.match(n),this.caller=r,this.injectFormFillingScript()};return u.prototype={injectFormFillingScript:function(){var t=r.getAsyncFillString(),n=this.document.createElement("script");n.textContent=t,(this.document.head||this.document.documentElement).appendChild(n),this.document.addEventListener("abineFilled",e.bind(this.fillFieldCallback,this),!0,!0)},fillFieldCallback:function(){this.currentFillCB&&this.currentFillCB()},fillFieldAsync:function(e,t){this.currentFillCB=t;var n=this.document.createEvent("Event");n.initEvent("fill",!0,!0);var r=this.document.getElementById("abineFillElement");r.setAttribute("value",e),r.dispatchEvent(n)},triggerFieldChange:function(e,n){this.currentFillCB=null,t(e.element).addClass("abineFillTarget").attr("blurFilled",1);try{var r=this.document.createEvent("Event");r.initEvent("triggerChange",!0,!0);var i=this.document.getElementById("abineFillElement");i.setAttribute("value",n),i.removeAttribute("skipPartial");try{i.dispatchEvent(r)}catch(e){}}catch(e){}t(".abineFillTarget",e.element.ownerDocument).removeClass("abineFillTarget")},fillSelectFieldAsync:function(e,t,n){this.currentFillCB=n;var r=this.document.createEvent("Event");r.initEvent("fillSelect",!0,!0);var i=this.document.getElementById("abineFillElement");i.setAttribute("value",e),t?i.setAttribute("skipPartial","1"):i.removeAttribute("skipPartial"),i.dispatchEvent(r)},fillTextField:function(e,n){e.setAttribute("mmautofilling","now"),t(e).val(n);try{this.triggerKeyboardEvent("keydown",e),this.triggerKeyboardEvent("keyup",e),this.triggerKeyboardEvent("keypress",e),this.triggerKeyboardEvent("change",e)}catch(e){}try{var r=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(r)}catch(e){}e.removeAttribute("mmautofilling","now")},triggerKeyboardEvent:function(e,t){var n=this.document.createEvent("KeyboardEvent");n.initKeyboardEvent?n.initKeyboardEvent(e,!0,!0,null,!1,!1,!1,!1,9,0):n.initKeyEvent&&n.initKeyEvent(e,!0,!0,null,!1,!1,!1,!1,9,0),t.dispatchEvent(n)},fillFields:function(t,n,r,i,a,o,s){this.formStrategy=t,"current"==n?this.fillCurrentFieldAsync(r,i,a,o,s):"email"==n?this.fillEmailFieldsAsync(r,i,a,o,s):"password"==n?this.fillPasswordFieldsAsync(r,i,a,o,s):"login"==n||"login-no-submit"==n?this.fillLoginFieldsAsync(r,i,a,o,s):"phone"==n?this.fillPhoneFieldsAsync(r,i,a,o,s):"address"==n?this.fillAddressFieldsAsync(r,i,a,o,s):"payment"==n?this.fillPaymentFieldsAsync(r,i,a,o,e.bind(function(){i.address&&this.hasVisibleField("/contact/postaladdress")?this.fillAddressFieldsAsync(r,i.address,a,o,s):s()},this)):"identity"==n&&this.fillIdentityFieldsAsync(r,i,a,o,s)},_elementInDocument:function(e){for(var t=e.ownerDocument;e=e.parentNode;)if(e==t)return!0;return!1},hasVisibleField:function(t){var n=this.formStrategy.getFields(),r=this,i=e.find(n,function(e){return!(!e.dataType||e.dataType!=t&&e.dataType.indexOf(t+"/")==-1)&&r.isVisible(e.element)});return!!i},reloadFieldElement:function(e){try{if(!this._elementInDocument(e.element)){var n=e.element.ownerDocument,r=null;if(e.id&&(r=n.getElementById(e.id)),!r&&e.name){var i=t("input[name="+e.name+"]",n);1==i.length&&(r=i[0])}if(!r&&e.className){var a="."+e.className.replace(/(^[\s]+)|([\s]+$)/g,"").replace(/[\s]+/g,".");i=t("select"==e.fieldType?"select"+a:"input"+a),1==i.length&&(r=i[0])}r&&(e.element=r)}}catch(e){}},reloadFormIfRequired:function(t){var n=this,r=e.find(t,function(e){return!n.isVisible(e.element)});if(r){var i=n.formStrategy.refreshOnFormChange(t);if(i!==t){for(var a in t)delete t[a];for(var a in i)t[a]=i[a]}}return t},fillFieldsValuesByType:function(n,r,i,a,o,s,l,c,u){if(t.isArray(a)){var d=this;e.async.series(a.map(function(e){return function(){d.fillFieldsByType(n,r,i,e,o,s,l,c,u)}}),u)}else this.fillFieldsByType(n,r,i,a,o,s,l,c,u)},fillFieldsByType:function(n,r,a,o,s,c,u,d,h){var f=!1;if(h=h||function(){},null===o||""==o||"undefined"==typeof o)return h(!1),!1;var p=this.getFieldsOfType(r,n,c,a,u),m=p.length;if(p=this.removedFieldsAlreadyFilled(p,o),m!=p.length&&(f=!0),0==p.length)return h(f),f;e(p).each(e.bind(function(e){e.element.setAttribute("mmautofilling","now"),t(e.element).removeData("abineManualTyped"),e.oldVal=t(e.element).val(),e.oldVal&&""!=e.oldVal&&"select"!=e.fieldType&&t(e.element).val("")},this));var y=!1;e(["uniqlo.com"]).contains(this.domain)&&(y=!0);var g=this;return e(p).each(e.bind(function(n){function c(e){var n="select"!=e.fieldType&&!g.domain.match(l)&&e.oldVal!=t(e.element).val();if(t(e.element).data("mmFillType",a),n&&(g.triggerFieldChange(e,o),y))try{t(e.element).click()}catch(e){}delete e.oldVal,s&&(e.disposableGUID=s.disposableGUID,g.formStrategy.triggerPanelFillEvent({domain:s.domain,origin:s.origin,accountId:s.accountId,field:e}))}if("select"!=n.fieldType){var u=["tdameritrade.com"];u.indexOf(g.domain)==-1&&t(n.element).focus()}if(a&&a.match("/password")&&"text"==n.element.type){try{t(n.element).val(o)}catch(e){}var h=n.element.form;i(e.bind(function(n){var i=t("[type='password']",h);if(i.length>0){var a=e(r).find(function(e){return e.element==i[0]});n=a||n;try{i.focus()}catch(e){}t(i).val(o),g.markFieldFilled(n),c(n)}else c(n)},g,n),100)}else{o+="","select"!=n.fieldType?t(n.element).val(o):f=g.setSelectValue(n,o,d);var p;if(p="select"==n.fieldType?g.getSelectValue(n.element):t(n.element).val(),p==o){if(f=!0,"select"==n.fieldType&&a.match(/month/i)){var m=g.getSelectValues(n.element),v=m[m.length-1];if(11==parseInt(v)){var b=parseInt(o)-1;g.setSelectValue(n,b,d)}}n.maxlength&&o.length>n.maxlength&&(f=!1)}g.markFieldFilled(n),c(n)}},this)),e(p).each(e.bind(function(e){e.element.removeAttribute("mmautofilling")},this)),h(f),f},markFieldFilled:function(e){t(e.element).css({color:"#0000aa","background-color":"#ffffee"})},isVisible:function(e){try{return t(e).is(":visible")&&"hidden"!=t(e).css("visibility")}catch(e){}return!0},getMonthAlternates:function(e){var t=[],n=parseInt(e);return t.push(s["long"][n-1]),t.push(s["short"][n-1]),n<10?(t.push("0"+n),t.push(""+n)):t.push(""+n),t},postFillAsync:function(e,n,r,i,a,o,s){var l=this;t(e.element).data("mmFillType",n),l.markFieldFilled(e);var c;if(c="select"==e.fieldType?l.getSelectValue(e.element):t(e.element).val(),o||c==r){if(o=!0,"select"==e.fieldType&&n.match(/month/i)&&!isNaN(parseInt(r))){var u=l.getSelectValues(e.element),d=u[u.length-1];if(11==parseInt(d)){var h=parseInt(r)-1;l.setSelectValue(e,h)}}e.maxlength&&r.length>e.maxlength&&(o=!1)}delete e.oldVal,i&&(e.disposableGUID=i.disposableGUID,l.formStrategy.triggerPanelFillEvent({domain:i.domain,origin:i.origin,accountId:i.accountId,field:e})),s(o)},getSelectOptions:function(e){var n,r=t(e).data("selectize"),i=[];if(r){n=r.options;for(var a in n)i.push({text:n[a].text,value:n[a].value})}else{n=e.options;for(var o=0;o<n.length;o++)i.push({text:n[o].text,value:n[o].value})}return i},getSelectTextValues:function(t){return e.map(this.getSelectOptions(t),function(e){return e.text})},getSelectValues:function(t){return e.map(this.getSelectOptions(t),function(e){return e.value})},getSelectValue:function(e){var n=t(e).data("selectize");return n?n.getValue():t(e).val()},setSelectValue:function(e,t,n){var r=e.element,i=!1,a=!1,o=(t||"").toString().toLowerCase().replace(c,""),s=r.getElementsByTagName("option");if(s&&s.length>0){for(var l=-1,u=0;u<s.length;u++){var d=(s[u].text||"").toLowerCase().replace(c,"");if(s[u].getAttribute("value")==t||d==o){s[u].selected||(s[u].selected=!0,i=!0),a=!0;break}l==-1&&d.indexOf(o)!=-1&&(l=u)}a||l==-1||n||(s[l].selected||(i=!0,s[l].selected=!0),a=!0)}return i&&this.triggerFieldChange(e,t),a},fillFieldOfTypeAsync:function(e,n,r,i,a,o){var s=this;"select"==e.fieldType?(t(e.element).addClass("abineFillTarget"),this.fillSelectFieldAsync(r,a,function(){t(".abineFillTarget",e.element.ownerDocument).removeClass("abineFillTarget");var l="true"==t(e.element).attr("abineFillResponse");t(e.element).removeAttr("abineFillResponse"),s.postFillAsync(e,n,r,i,a,l,o)})):(t(e.element).addClass("abineFillTarget"),this.fillFieldAsync(r,function(){t(".abineFillTarget",e.element.ownerDocument).removeClass("abineFillTarget");var l="true"==t(e.element).attr("abineFillResponse");t(e.element).removeAttr("abineFillResponse"),s.postFillAsync(e,n,r,i,a,l,o)}))},findAndFillRemovedFieldAsync:function(e,t,n,r,i,a){var o,s=this;if(e.id&&""!=e.id&&(o=s.document.getElementById(e.id)),!o&&e.name&&""!=e.name){var l=s.document.getElementsByName(e.name);1==l.length&&(o=l[0])}o?(e.element=o,s.fillFieldOfTypeAsync(e,t,n,r,i,function(e){a(e)})):a(!1)},fillFieldsOfTypeAsync:function(e,n,r,a,o,s,l){var c=this,u=null;return 0==e.length?void l(s):(u=e.shift(),void c.fillFieldOfTypeAsync(u,n,r,a,o,function(d){s=s||d;var h=u.element.ownerDocument;t.contains(h.documentElement,u.element)?i(function(){c.fillFieldsOfTypeAsync(e,n,r,a,o,s,l)},100):c.findAndFillRemovedFieldAsync(u,n,r,a,o,function(t){s=s||t,c.fillFieldsOfTypeAsync(e,n,r,a,o,s,l)})}))},getFieldsOfType:function(n,r,i,a,o){var s=this,l=e(n).filter(function(e){if(s.reloadFieldElement(e),null==a&&e.signature==r)return!0;if(e.signature!=r){var n=t(e.element);if(n.data("abineManualTyped")){if(""!=n.val())return!1;n.removeData("abineManualTyped")}}return e.dataType&&(!i&&e.dataType.indexOf(a)!=-1||i&&e.dataType==a)&&(o||s.isVisible(e.element))});return l},removedFieldsAlreadyFilled:function(n,r){var i=(r+"").toLowerCase().replace(c,"");return e(n).filter(function(e){if("select"==e.fieldType&&e.element.selectedIndex>=0){var n=(t(e.element).val()||"").toString();if(n==r||n.toLowerCase().replace(c,"")==i)return!1;try{var a=e.element.options[e.element.selectedIndex].text;if(a==r||a.toLowerCase().replace(c,"")==i)return!1}catch(e){}}return!0})},fillFieldsValuesByTypeAsync:function(n,r,i,a,o,s,l,c,u){if(t.isArray(a)){var d=this;e.async.series(a.map(function(e){return function(t){d.fillFieldsByTypeAsync(n,r,i,e,o,s,l,c,t)}}),u)}else this.fillFieldsByTypeAsync(n,r,i,a,o,s,l,c,u)},fillFieldsByTypeAsync:function(n,r,i,a,o,s,l,c,u){if(!this.asyncFilling)return this.fillFieldsByType(n,r,i,a,o,s,l,c,u);var d=this,h=!1;if(u=u||function(){},null===a||""==a||"undefined"==typeof a)return u(),h;a+="";var f=this.getFieldsOfType(r,n,s,i,l),p=f.length;if(f=this.removedFieldsAlreadyFilled(f,a),p!=f.length&&(h=!0),0==f.length)return u(h),h;e(f).each(e.bind(function(e){e.element.setAttribute("mmautofilling","now"),t(e.element).removeData("abineManualTyped"),e.oldVal=t(e.element).val(),e.oldVal&&""!=e.oldVal&&t(e.element).val("")},this));var d=this;d.fillFieldsOfTypeAsync(e.clone(f),i,a,o,c,h,function(t){e(f).each(e.bind(function(e){e.element.removeAttribute("mmautofilling")},d)),u(t)})},fillCurrentFieldAsync:function(e,t,n,r,i){var a=this.formStrategy.getFields(),o={domain:n,origin:r};i=i||function(){},r&&r.origin&&(o=r,o.domain=n),this.fillFieldsByTypeAsync(e,a,null,t,o,!1,null,null,i)},fillEmailFieldsAsync:function(e,t,n,r,i){var a=this.formStrategy.getFields(),o={domain:n,origin:r};i=i||function(){},r&&r.origin&&(o=r,o.domain=n),this.fillFieldsByTypeAsync(e,a,"/contact/email",t,o,!1,null,null,i)},fillPasswordFieldsAsync:function(e,t,n,r,i){var a=this.formStrategy.getFields(),o={domain:n,origin:r},s=!1;i=i||function(){},r&&r.origin&&(o=r,o.domain=n,s=o.exactTypeMatch),this.fillFieldsByTypeAsync(e,a,"/password",t,o,s,null,null,i)},fillPhoneFieldsAsync:function(t,r,i,a,s){var l=this.formStrategy.getFields(),c={domain:i,origin:a};s=s||function(){};var u=l[t],d="";u&&u.dataType&&u.dataType.match(/work|home|mobile/)&&u.dataType.match(/phone/)&&(d="/"+u.dataType.split("/").pop());var h,f,p,m,y=r.country_code,g=r.number;1===parseInt(y)?(h=g.substr(0,3),p=g.substr(3,3),m=g.substr(6,4),f=p+"-"+m):f="+"+y+g;var v=this,b=!1;e.async.series([function(e){v.fillFieldsByTypeAsync(t,l,"/contact/phone/countrycode"+d,y,null,null,null,!0,function(r){r?(b=!0,e()):v.fillFieldsByType(t,l,"/contact/phone/countrycode"+d,o[y],null,null,null,!0,function(r){r?(b=!0,e()):v.fillFieldsValuesByType(t,l,"/contact/phone/countrycode"+d,n[o[y]],null,null,null,!1,function(n){n?(b=!0,e()):v.fillFieldsByType(t,l,"/contact/phone/countrycode"+d,y,null,null,null,!1,function(t){b=t,e()})})})})},function(e){b||"3"!=y[0]&&"4"!=y[0]||(g="0"+g),v.fillFieldsByTypeAsync(t,l,"/contact/phone/full",g,c,!0,null,null,function(){e()})},function(e){v.fillFieldsByTypeAsync(t,l,"/contact/phone"+d,g,c,!0,null,null,function(){e()})},function(e){v.fillFieldsByTypeAsync(t,l,"/contact/phone/number"+d,f,null,null,null,null,function(){e()})},function(e){v.fillFieldsByTypeAsync(t,l,"/contact/phone/areacode"+d,h,null,null,null,null,function(){e()})},function(e){v.fillFieldsByTypeAsync(t,l,"/contact/phone/exchange"+d,p,null,null,null,null,function(){e()})},function(e){v.fillFieldsByTypeAsync(t,l,"/contact/phone/local"+d,m,null,null,null,null,function(){e()})}],function(){s()})},fillBirthDateAsync:function(e,t,n,r,i,a,o){var s=this.getMonthAlternates(r),l=this;this.fillAlternatesAsync(e,t,"/birthdate/birthmonth",s,!1,!0,function(){l.fillFieldsByTypeAsync(e,t,"/birthdate/birthyear",n,a,!1,null,null,function(){l.fillFieldsByTypeAsync(e,t,"/birthdate/birthday",i,a,!1,null,null,o)})})},fillIdentityFieldsAsync:function(n,r,a,o,s){var l=this.formStrategy.getFields(),c={domain:a,origin:o};s=s||function(){};var u=this;e.async.series([function(e){var t=[];r.first_name&&t.push(r.first_name),r.middle_name&&t.push(r.middle_name),r.last_name&&t.push(r.last_name),u.fillFieldsByTypeAsync(n,l,"/nameperson/full",t.join(" "),c,!1,null,null,function(){e()})},function(e){u.fillFieldsByTypeAsync(n,l,"/nameperson/first",r.first_name,c,!1,null,null,function(){e()})},function(e){u.fillFieldsByTypeAsync(n,l,"/nameperson/middle",r.middle_name,c,!1,null,null,function(){e()})},function(e){u.fillFieldsByTypeAsync(n,l,"/nameperson/last",r.last_name,c,!1,null,null,function(){e()})},function(e){u.fillFieldsByTypeAsync(n,l,"/person/gender",r.gender,c,!1,null,null,function(){e()})},function(e){u.fillFieldsByTypeAsync(n,l,"/nameperson/friendly",r.username,c,!1,null,null,function(){e()})},function(e){u.fillFieldsByTypeAsync(n,l,"/url",r.url,c,!1,null,null,function(){e()})},function(e){u.fillFieldsByTypeAsync(n,l,"/company/name",r.company,c,!1,null,null,function(){e()})},function(e){u.fillFieldsByTypeAsync(n,l,"/company/position",r.designation,c,!1,null,null,function(){e()})},function(e){u.fillFieldsByTypeAsync(n,l,"/socialSecurityNumber",r.ssn,c,!1,null,null,function(){e()})},function(e){u.fillFieldsByTypeAsync(n,l,"/driverLicense",r.ssn,c,!1,null,null,function(){e()})},function(e){r.dob_year&&r.dob_day?u.fillBirthDateAsync(n,l,r.dob_year,r.dob_month,r.dob_day,c,function(){e()}):e()},function(e){r.address?(delete r.address.first_name,delete r.address.last_name,u.hasVisibleField("/contact/postaladdress")?u.fillAddressFieldsAsync(n,r.address,a,o,function(){e()}):e()):e()},function(e){r.password?u.fillPasswordFieldsAsync(n,r.password,a,{origin:"strong",exactTypeMatch:!0},function(){e()}):e()},function(e){r.email?u.fillEmailFieldsAsync(n,r.email,a,o,function(){e()}):r.masked_email?u.fillEmailFieldsAsync(n,r.masked_email,a,"disposable",function(){e()}):e()},function(e){r.phone?u.fillPhoneFieldsAsync(n,r.phone,a,o,function(){e()}):e()},function(n){var a=e.find(l,function(e){return"/financial/creditcard/number"==e.dataType&&t(e.element).is(":visible")});a&&"mask"==r.card&&i(function(){a.element.scrollIntoView(),t(a.element).data("abine-params",{step:"new_card"}),t(a.element).trigger("showpanel")},100),n()}],function(){s()})},fillLoginFieldsAsync:function(e,t,n,r,i){var a=this.formStrategy.getFields(),o={domain:n,origin:r,accountId:t.accountId};r&&r.origin&&(o=r,o.domain=n);var s=a[e],l="";s&&s.dataType&&s.dataType.indexOf("/login")!=-1&&(l="/login");var c=this,u="myclubwyndham.com"==n;c.fillFieldsByTypeAsync(e,a,"/contact/email"+l,t.email,o,null,u,null,function(){c.fillFieldsByTypeAsync(e,a,"/nameperson/friendly",t.username,o,null,u,null,function(){"changepassword"!=o.origin?c.fillFieldsByTypeAsync(e,a,"/password"+l,t.password,o,!0,u,null,i):c.fillFieldsByTypeAsync(e,a,"/passwordold",t.password,o,!0,null,null,i)})})},fillCountryFieldsAsync:function(t,r,a,o,s,l,c){function u(){var t=1;e.contains(["ebay.com"],a)&&(t=500),e.contains(["sierratradingpost.com"],a)&&(t=1500),i(function(){c()},t)}var d=this,h=!0;r&&r in n?d.fillFieldsValuesByTypeAsync(t,o,"/contact/country"+s,n[r],l,!1,h,!0,function(e){return e?void u():void d.fillFieldsByTypeAsync(t,o,"/contact/countrycode"+s,r,l,!1,h,!0,function(e){return e?void u():void d.fillFieldsByTypeAsync(t,o,"/contact/country"+s,r,l,!1,h,!0,function(e){return e?void u():void d.fillFieldsByType(t,o,"/contact/country"+s,"US"==r?"USA":null,l,!1,h,!0,function(e){return e?void u():void d.fillFieldsValuesByTypeAsync(t,o,"/contact/country"+s,n[r],l,!1,h,null,function(){u()})})})})}):d.fillFieldsByTypeAsync(t,o,"/contact/country"+s,r,l,!1,h,null,function(){u()})},fillAddressFieldsAsync:function(t,n,r,o,s){var l=this.formStrategy.getFields(),c={domain:r,origin:o},s=s||function(){},u="",d=l[t];if(d&&d.dataType){var h=d.dataType.split("/");if(h.length>3&&(u="/"+h.pop(),u.match(/bill|ship|home|business/)||(u="")),""==u&&d.multipleAddress){var f={};e.each(l,function(e){return"addressGroup"in e?void(e.addressGroup===d.addressGroup&&(f[e.signature]=e)):void(f[e.signature]=e)}),l=f}}if(d&&"addressGroup"in d)e.each(l,function(e){"addressGroup"in e&&e.addressGroup===d.addressGroup&&(e.addressFilled=!0)});else{var f={};e.each(l,function(e){e.addressFilled||(f[e.signature]=e),!e.addressFilled&&"addressGroup"in e&&(e.addressFilled=!0)}),l=f}var p=this,m=this.getFieldsOfType(l,t,!1,"/contact/state"+u,!1),y=!0;m.length>0&&(y=!1),e.async.series([function(e){p.fillCountryFieldsAsync(t,n.country,r,l,u,c,function(){e()})},function(e){l=p.formStrategy.refreshOnFormChange(l),e()},function(e){var r=[];n.first_name&&r.push(n.first_name),n.last_name&&r.push(n.last_name),p.fillFieldsByTypeAsync(t,l,"/nameperson/full",r.join(" "),c,!1,null,null,function(){e()})},function(e){p.fillFieldsByTypeAsync(t,l,"/nameperson/first",n.first_name,c,null,null,null,function(){e()})},function(e){p.fillFieldsByTypeAsync(t,l,"/nameperson/last",n.last_name,c,null,null,null,function(){e()})},function(e){p.fillFieldsByTypeAsync(t,l,"/contact/postaladdress"+u,n.address1,c,!0,null,null,function(){e()})},function(e){u?e():p.fillFieldsByTypeAsync(t,l,"/contact/postaladdress/",n.address1,c,!1,null,null,function(){e()})},function(e){p.fillFieldsByTypeAsync(t,l,"/contact/postaladdressAdditional"+u,n.address2,c,null,null,null,function(){e()})},function(e){p.fillFieldsByTypeAsync(t,l,"/contact/city"+u,n.city,c,null,null,null,function(){e()})},function(t){var n=1;e.contains(["express.com"],r)&&(n=1500),i(t,n)},function(e){l=p.formStrategy.refreshOnFormChange(l),p.fillFieldsByTypeAsync(t,l,"/contact/postalcode"+u,n.zip,c,null,null,null,function(){
e()})},function(t){var n=500;e.contains(["express.com"],r)&&(n=1500),i(t,n)},function(e){l=p.formStrategy.refreshOnFormChange(l),p.fillFieldsByTypeAsync(t,l,"/contact/state/code"+u,n.state,c,!1,y,null,function(r){return r?void e():void(n.state&&n.state in a?p.fillFieldsByTypeAsync(t,l,"/contact/state"+u,a[n.state],c,!1,y,!1,function(r){r?e():p.fillFieldsByTypeAsync(t,l,"/contact/state"+u,n.state,c,!1,y,!0,function(){e()})}):p.fillFieldsByTypeAsync(t,l,"/contact/state"+u,n.state,c,!1,y,null,function(){e()}))})}],function(){s()})},fillIssuedToFieldsAsync:function(e,t,n,r){var i=this;n?i.fillFieldsByTypeAsync(e,t,"/financial/creditcard/issuedto",n,null,!0,null,null,function(){var a=n.split(" ");i.fillFieldsByTypeAsync(e,t,"/financial/creditcard/issuedto/first",a[0],null,null,null,null,function(){a.length>1?i.fillFieldsByTypeAsync(e,t,"/financial/creditcard/issuedto/last",a[1],null,null,null,null,function(){r()}):r()})}):r()},fillAlternatesAsync:function(e,t,n,r,i,a,o){var s=this,l=null;return r&&0!=r.length?(l=r.shift(),void this.fillFieldsByTypeAsync(e,t,n,l,null,i,a,null,function(l){l?o():s.fillAlternatesAsync(e,t,n,r,i,a,o)})):void o()},fillPaymentFieldsAsync:function(t,n,r,a,o){o=o||function(){};var s={domain:r,origin:a},l=this.formStrategy.getFields(),c=n.number,u=n.type,d=((n.first_name||"")+" "+(n.last_name||"")).replace(/(^[\s]+)|([\s]+$)/g,""),h=(parseInt(n.expiry_month)<10?"0":"")+parseInt(n.expiry_month),f=n.expiry_year,p=n.cvc,m=this,y=[u],g=!1;u.toLowerCase().indexOf("master")!=-1?y=["master","master card","mastercard"]:u.match(/amex|american/i)&&(y=["american_express","amex","american express"],g=!0),m.fillAlternatesAsync(t,l,"/financial/creditcard/type",y,null,null,function(){m.fillFieldsByTypeAsync(t,l,"/financial/creditcard/number",c,s,null,null,null,function(){m.fillFieldsByTypeAsync(t,l,"/financial/creditcard/number/part1",c.substr(0,4),s,null,null,null,function(){m.fillFieldsByTypeAsync(t,l,"/financial/creditcard/number/part2",c.substr(4,4),s,null,null,null,function(){m.fillFieldsByTypeAsync(t,l,"/financial/creditcard/number/part3",c.substr(8,4),s,null,null,null,function(){m.fillFieldsByTypeAsync(t,l,"/financial/creditcard/number/part4",c.substr(12,4),s,null,null,null,function(){m.fillFieldsByTypeAsync(t,l,"/financial/creditcard/number/amex/part1",g?c.substr(0,4):null,s,null,null,null,function(){m.fillFieldsByTypeAsync(t,l,"/financial/creditcard/number/amex/part2",g?c.substr(4,6):null,s,null,null,null,function(){m.fillFieldsByTypeAsync(t,l,"/financial/creditcard/number/amex/part3",g?c.substr(10,5):null,s,null,null,null,function(){var n=500;e.contains(["jjill.com"],r)&&(n=2500),e.contains(["bestbuy.com"],r)&&(m.fillFieldsByTypeAsync(t,l,"/financial/creditcard/verification",p,s,null,null,null,function(){}),n=1e3),i(e.bind(function(){l=m.formStrategy.refreshOnFormChange(l);var n=m.getMonthAlternates(h);m.fillAlternatesAsync(t,l,"/financial/creditcard/expirymonth",n,!1,!0,function(){var n=parseInt(f)%100;m.fillAlternatesAsync(t,l,"/financial/creditcard/expiryyear",[f,n],!0,!0,function(){var r=[n],i=!1;e.each(l,function(e){e&&e.dataType&&"/financial/creditcard/expiryyear2"==e.dataType&&(i="select"==e.fieldType)}),i&&r.unshift(f),m.fillAlternatesAsync(t,l,"/financial/creditcard/expiryyear2",r,!1,!0,function(){m.fillIssuedToFieldsAsync(t,l,d,function(){m.fillFieldsByTypeAsync(t,l,"/financial/creditcard/expiry",h+"/"+f,null,!0,null,null,function(){m.fillFieldsByTypeAsync(t,l,"/financial/creditcard/expiry2",h+"/"+n,null,!0,null,null,function(){m.fillFieldsByTypeAsync(t,l,"/financial/creditcard/verification",p,s,null,null,null,o)})})})})})})},this),n)})})})})})})})})})},autoLogin:function(e,n){var i=n.length>0?n.at(0):null,a=i?i.get("submit_btn"):"",o=!1;if(a&&a.length>0){var s=t(a,e.ownerDocument).first();s.length>0&&(r.simulate(s[0],"mousedown"),r.simulate(s[0],"click"),o=!0)}if(!o){var s=t(":submit",e).first();s.length>0?(r.simulate(s[0],"mousedown"),r.simulate(s[0],"click")):t(e).submit()}}},u}.apply(this,[])}),ABINE_DNTME.define("abine/proxies",["documentcloud/underscore","abine/core","abine/contentMessenger","abine/timer"],function(e,t){function n(e,t){if(!i){t=t||function(){},i=e||ABINE_DNTME.contentMessenger;var n=""+Math.random();i.once("background:stub:response:"+n,function(e){t(e)}),i.send("contentManager:proxy:connect",n)}}function r(){i&&(i=null)}var i,a=t.BaseClass.extend({initialize:function(t){var n=this;e.each(t.methods,function(e){n.addMethod(e)}),e.each(t.asyncMethods,function(e){n.addAsyncMethod(e)}),this._require=t.require},addMethod:function(e){this[e]=function(){var t=function(){},n=arguments;arguments.length>0&&"function"==typeof arguments[arguments.length-1]?(t=arguments[arguments.length-1],n=Array.prototype.slice.call(arguments,0,-1)):n=Array.prototype.slice.call(arguments,0),this.call({method:e,params:n},t)}},addAsyncMethod:function(e){this[e]=function(){var t=function(){},n=arguments;arguments.length>0&&"function"==typeof arguments[arguments.length-1]?(t=arguments[arguments.length-1],n=Array.prototype.slice.call(arguments,0,-1)):n=Array.prototype.slice.call(arguments,0),this.callAsync({method:e,params:n},t)}},call:function(e,t){var n=""+Math.random();e.proxyId=this._proxyId,e.callId=n,e.require=this._require,t&&i.once("background:stub:response:"+n,function(e){t(e)}),i.send("contentManager:proxy:call",e)},callAsync:function(e,t){var n=""+Math.random();e.proxyId=this._proxyId,e.callId=n,e.require=this._require,t&&i.once("background:stub:response:"+n,function(e){t(e.err,e.data)}),i.send("contentManager:proxy:callAsync",e)}}),o=new a({require:"abine/securityManager",methods:["isLocked","login","isInitialized","openPage","openPostInstall","openLink","refreshData","refreshRules","resetData","openWindow","isMaskmeInstalled","getBillingManager"]}),s=new a({require:"abine/webapp",methods:["openHome","openDashboard","openWallet","openMasking","openEmails","openPhones","openCards","openLogin","openMaskedEmailsIn30","openPremium","openNewFeatureAdded","openSnowman","openBlacklist","openSettings","openStats","openHelp","openPasswordSetup","openDnt2UpgradePage","openPiwikCampaign","openWeeklyReport","openDntAnywhere","openForgotPassword","openFAQ","openPage","openCashForCardsFaq","openCashForCardsSignup","openUnderstandingTracking","openTour","openAccounts"]}),l=new a({require:"abine/modules/license",methods:[],asyncMethods:["sendFeedbackEmail","refreshEntitlements","refreshLastFourCardDigits","register","login","subscribe","incrementMedalsEarned","incrementMedalsEarnedWithCurrentMedals","retrieveMedalsEarned","logAction","logSplitData","logPasswordFillData","getGenericBiometricKey","logCheckout"]}),c=new a({require:"abine/modules/payments",methods:[],asyncMethods:["retrieveCardCredit","retrieveCardFee","verifyCardRequest"]}),u=new a({require:"abine/modules/panels",methods:[],asyncMethods:["getDNTMePanel","changePanelShowRate","getDNTMeGrowl"]}),d=new a({require:"abine/pageEvents",asyncMethods:["processAction"],methods:[]}),h=new a({require:"abine/modules/mappings",asyncMethods:["makeDailyMappingCheck","getOneFormMappings","getFormRules"],methods:[]}),f=new a({require:"abine/memoryStore",methods:["set"],asyncMethods:["get"]});return{Proxy:a,connect:n,disconnect:r,securityManager:o,webapp:s,licenseModule:l,paymentsModule:c,panelsModule:u,pageEventsModule:d,mappingsModule:h,memoryStore:f}}),ABINE_DNTME.define("abine/responseCodes",[],function(){return{UNKNOWN_ERROR:"unknown error",SUCCESS:"successful",ERROR:"error",SERVICE_UNAVAILABLE_ERROR:"service unavailable error",SCHEDULED_DOWNTIME:"scheduled downtime",MISSING_PARAMETERS:"missing parameters",UNAUTHORIZED:"unauthorized bad token",NO_ACCESS_FOR_FEATURE:"no access to requested feature",INVALID_PASSWORD:"invalid password",BIOMETRIC_AUTH_FAILED:"biometric auth failed",ACCOUNT_ALREADY_EXISTS:"account already exists for that email",SAVE_NEW_USER_ERROR:"error saving new user",FAILED_CREATING_TARGET_EMAIL:"failed to create target email",FAILED_TO_UPDATE_USER:"error updating user",NO_ACCOUNT_FOUND_FOR_EMAIL:"no account found for email",ACCOUNT_MARKED_FOR_DELETION:"account has been marked for deletion",ACCOUNT_HAS_BEEN_LOCKED:"account has been locked",ACCOUNT_HAS_BEEN_BANNED:"account has been banned",WRONG_PASSWORD:"wrong password",INVALID_EMAIL_ADDRESS:"invalid email address",NO_RECURLY_ACCOUNT_FOUND:"no recurly account found",MFA_CODE_REQUIRED:"mfa code required",DOWNGRADE_SCHEMA_NOT_ALLOWED:"downgrade of schema_version is not allowed",SAVE_CLIENT_DATA_ERROR:"errors saving client data",DESTROY_CLIENT_DATA_ERROR:"errors destroying client data",NO_CLIENT_DATA_FOUND:"no client data found",USER_EXISTS_FOR_CLIENT_DATA_DELETION:"cannot destroy client data when user exists",UPGRADE_REQUIRED:"upgrade required",PHONE_NOT_FOUND:"phone not found",NO_DISPOSABLE_PHONE:"no disposable phone",FAILED_TO_SAVE_PHONE:"failed to save phone",PHONE_ALREADY_VALIDATED:"phone already validated",NO_NUMBERS_AVAILABLE:"no numbers available",FAILED_TO_SEND_VERIFICATION_CODE:"failed to send verification code",WRONG_VERIFICATION_CODE:"wrong verification code",OLD_PHONE_NOT_FOUND:"old phone not found",COUNTRY_NOT_SUPPORTED:"country not supported",COUNTRY_CHANGE_NOT_SUPPORTED:"country change not supported",ERROR_CREATING_DISPOSABLE:"error creating disposable",MISSING_USER_PARAMS_ERROR_CODE:"missing user params",NO_BILLING_ACCOUNT_FOR_USER_ERROR_CODE:"no billing account for user",REQUEST_ALREADY_EXISTS_ERROR_CODE:"request already exists",NO_CARDS_AVAILABLE_ERROR_CODE:"no cards available",REQUESTED_AMOUNT_OVER_LIMIT_ERROR_CODE:"requested amount over limit",REQUESTED_AMOUNT_BELOW_MINIMUM_ERROR_CODE:"requested amount below minimum",REQUESTED_AMOUNT_INVALID_ERROR_CODE:"requested amount invalid",BILLING_FAILED_ERROR_CODE:"billing failed",BILLING_DECLINED_ERROR_CODE:"billing declined",BILLING_COMPANY_FAILED_ERROR_CODE:"billing company failed",NO_CARD_FOUND_ERROR_CODE:"no card found",NO_BILLING_TRANSACTION_FOUND_ERROR_CODE:"no billing transaction found",FRAUD_SOFT_LIMIT_REACHED:"fraud soft limit",REFUND_FAILED_ERROR_CODE:"refund failed",PROVIDER_CANCEL_FAILED_ERROR_CODE:"provider cancel failed",PROVIDER_READ_FAILED_ERROR_CODE:"provider read failed",PROVIDER_CARD_CREATION_FAILED_ERROR_CODE:"provider card creation failed",FRAUD_HARD_LIMIT_REACHED:"fraud hard limit reached",CARD_ALREADY_DEACTIVATED_ERROR_CODE:"card already deactivated",FRAUD_VERIFIED_SOFT_LIMIT_REACHED:"fraud verified soft limit",FRAUD_PLATFORM_UNAVAILABLE:"fraud verification unavailable",FRAUD_HIGH_RISK_COUNTRY_ERROR_CODE:"high risk country ban",BILLING_IN_NON_US_ERROR_CODE:"billing in non us",GREY_LISTED_ERROR_CODE:"grey listed user",GLOBAL_SOFT_LIMIT_REACHED:"global soft limit",DUPLICATE_CARD_ERROR_CODE:"duplicate card used ban",REJECTED_DOMAIN_ERROR_CODE:"domains known to not accept masked cards",BANNED_DOMAIN_ERROR_CODE:"banned domain",SPLIT_INTRUSIVE_NON_INTRUSIVE:"7",SPLIT_INTRUSIVE_CONTROL:"8",SPLIT_INTRUSIVE_ALWAYS_REG:"9",SPLIT_INTRUSIVE_GOT_IT_REG:"10",SPLIT_INTRUSIVE_COMPLETE_SETUP_BUTTON:"11",SPLIT_WALLET_OFF:"12",SPLIT_WALLET_ON:"13",SPLIT_ICON_PANELS_CLICK_ICON_FOR_PANEL:"32",SPLIT_ICON_PANELS_SHOW_ICON_WITH_NORMAL_PANELS:"33",SPLIT_ICON_PANELS_NORMAL:"34"}}),ABINE_DNTME.define("abine/url",function(){function e(e){return e?e.toLowerCase().replace(/\w+/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1)}):e}function t(e){var t=e.match(o);return t&&t.length>1?t[1].toString():e}function n(e){var n=t(e);if(n.match(s)||n.match(l))return n;var r=n.split(".");if(r.length<2)return n;var o=r.pop(),c=r.pop(),u=c+"."+o;if(i.test(u)&&r.length>0&&(o=u,c=r.pop(),u=c+"."+o),a.test(u)&&r.length>0&&!n.match(/signup.wordpress.com|new.aol.com|(oauth|www).squarespace.com|secure.onsugar.com|www.tumblr.com/i)){var d=r.pop();u=d+"."+u}return u}function r(t){if(t=n(t),t.match(s))return t;var r=t.split(".");if(r.length>2){var o=r.pop(),l=r.pop(),t=l+"."+o;if(i.test(t)&&r.length>0&&(o=t,l=r.pop(),t=l+"."+o),a.test(t)&&r.length>0){var c=r.pop();return e(l+" "+c)}return e(l)}return e(r[0])}var i=/^(((co|ac|go|ed|ga|mn|nj|nc|or|ne|in|gr|ca|on|pa|qc|bc|sh|at|va|us|il|tv|me|lg|at|ny|gv|com|edu|org|net|gov|mil|biz)\...)|(163\.com)|(kiev\.ua)|(gob\.pe)|(gen\.tr)|(waw.pl)|(jus.br))$/,a=/^(((go|typepad|tumblr|blogspot|squarespace|wordpress|myshopify|blogfa|blog|blogs|blinkweb|ning|posterous|over-blog|mihanblog|appspot|webs|weebly|onsugar|ucoz|uk|pch|ecwid)(\.com|\.in))|(nic\.in)|((ucoz|spb|narod)\.ru)|(blog\.163\.com)|((gouv|free)\.fr)|(uol\.com\.br)|(web\.id)|(gob\.mx)|(blogg\.se)|(home.pl))$/,o=/^http(?:s)?\:\/\/([^/\?\#]+)/im,s=/^[0-9\.]+(:[0-9]+)?$/,l=/^localhost(:[0-9]+)?$/,c={getHostname:t,getTLD:n,getSiteName:r};return c}),ABINE_DNTME.define("abine/window",["documentcloud/underscore","abine/timer","jquery"],function(e,t,n){function r(t){var n=[];return e.each(t,function(e,t){n.push(t.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})+":"+e)}),n.join(" !important;")}function i(t,n){e.each(n,function(e,n){t.setAttribute(n,e)})}var a="panel.html",o=function(){},s=function(e,n){e.documentElement?e.documentElement.appendChild(n):t.setTimeout(function(){s(e,n)},100)};return{createTab:function(t,n){function r(r){var o=e.find(r,function(e){return e.url.indexOf(a)!=-1});o||t.doNotOpenNewTab?o&&(browser.tabs.update(o.id,{active:!t.doNotActivate,url:i}),browser.windows.get(o.windowId,function(e){"minimized"==e.state&&browser.windows.update(e.id,{state:"normal"}),browser.windows.update(e.id,{focused:!0}),n()})):(browser.tabs.create({active:!0,url:i}),n())}n=n||o;var i=t.localUrl?browser.extension.getURL(t.localUrl):t.url;if(t.force)return browser.tabs.create({active:!0,url:i}),void n();var a=i.replace(/http[s]?/i,"").replace(/\?.*/i,"").replace(/\#.*/i,"");browser.tabs.query({},r)},getWebappTabs:function(t){browser.tabs.query({url:ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost+"/*"},function(n){var r=[];e.each(n,function(e){r.push(e.id)}),t(r)})},openWindow:function(e,t,n){browser.windows.create({url:e,width:t,height:n,focused:!0,type:"popup"})},reloadTab:function(t,n){function r(r){var o=e.find(r,function(e){return e.url.indexOf(a)!=-1});o||t.doNotOpenNewTab?o&&(browser.tabs.reload(o.id),t.doNotActivate||(browser.tabs.update(o.id,{active:!0}),browser.windows.get(o.windowId,function(e){"minimized"==e.state&&browser.windows.update(e.id,{state:"normal"}),browser.windows.update(e.id,{focused:!0}),n()}))):(browser.tabs.create({active:!0,url:i}),n())}n=n||o;var i=t.localUrl?browser.extension.getURL(t.localUrl):t.url,a=i.replace(/http[s]?/i,"").replace(/\?.*/i,"").replace(/\#.*/i,"");browser.tabs.query({},r)},createPanel:function(t){var n=t.localUrl?browser.extension.getURL(t.localUrl):t.url,o=t.document||document||window.document,l=t.panelWidth?t.panelWidth:368;if(!o)throw"Error. abine/window createPanel called without a document context.";var c=t.id||"abine"+Math.floor(1e8*Math.random());n=n?n:browser.extension.getURL(a)+"?"+c,console.log(n);var u=o.createElement("iframe"),d=o.createElement("div");return d.className=t.className||"abineContentPanel",u.className="abineContentFrame",i(d,{style:r(e.extend({backgroundColor:"transparent",margin:"0",padding:"0",display:"none",opacity:"1",filter:"alpha(opacity:100)"},t.style))}),i(u,{width:l+"px",allowTransparency:"true",frameborder:0,height:t.panelHeight+"px",scrolling:"no",src:n,id:c,style:r(e.extend({position:"relative",display:"block",background:"transparent",borderWidth:"0px",left:"0px",top:"0px",visibility:"visible",opacity:1,filter:"alpha(opacity:100)",margin:"0",padding:"0",height:t.panelHeight+"px",width:l+"px"}))}),d.appendChild(u),s(o,d,u),u},autoResizePanels:function(t){var r,i=t.document||document||window.document;i.getElementsByTagName("body")[0];if(t.frameId){var a=i.getElementById(t.frameId);a&&(r=[a.parentElement])}r||(r=i.getElementsByClassName(t.className||"abineContentPanel")),e(r).each(function(e){var r=n("iframe",e)[0];r.scrolling="no",n(r).height("auto");var i=n(r).width(),a=t.documentHeight;t.extraWidth&&(i+=t.extraWidth),t.extraHeight&&(a+=t.extraHeight),n(r).width(i),n(r).height(a),e.style.width=i+"px",e.style.height=a+"px";try{var o=parseInt(e.style.left),s=o+e.offsetWidth,l=e.ownerDocument.defaultView.innerWidth,c=e.ownerDocument.documentElement.scrollLeft+l;if(s>c){var u=s-c;if(o-u>0)e.style.left=o-u+"px";else if(e.style.left="0px",l<s-o){var d=Math.round(l/(s-o)*100);d-=1,d<80&&(d=80),r.style.zoom=d+"%",r.contentDocument.body.style.zoom=d+"%"}}}catch(e){}})},removePanels:function(t){function r(e,t){if(!t){var r=n("iframe",e);if(r.length>0&&(t=r[0]),!t)return}t.id.indexOf("doNotRemove")!=-1?n(t.parentNode).hide():t.parentNode.parentNode.removeChild(t.parentNode)}var i=t.document||document||window.document;if(t.iframe)return void r(null,t.iframe);var a=i.getElementsByClassName("abineContentPanel");e(a).each(function(e){r(e)})}}}),ABINE_DNTME.define("abine/contentMessenger",["documentcloud/underscore","abine/core"],function(e,t){var n=function(e){"FWD"==e.eventName?e.payload.to==ABINE_DNTME.context&&this.trigger(e.payload.eventName,e.payload.payload,e.payload.from):this.trigger(e.eventName,e.payload)},r=function(){throw"Error. Attempt to call destroyed ContentMessenger."},i=t.BaseClass.extend({initialize:function(){this.listener=e.bind(n,this),browser.runtime.onMessage.addListener(this.listener)},sendToCS:function(e,t,n){browser&&browser.extension&&browser.runtime.sendMessage({eventName:"FWD",payload:{to:e,from:ABINE_DNTME.context,eventName:t,payload:"undefined"==typeof n?{}:n}})},send:function(e,t){this.trigger(e,t),browser&&browser.extension&&browser.runtime.sendMessage({eventName:e,payload:"undefined"==typeof t?{}:t})},destroy:function(){this.off();try{browser.runtime.onMessage.removeListener(this.listener)}catch(e){}this.on=this.off=this.trigger=r}});return{ContentMessenger:i}}),ABINE_DNTME.define("abine/assets",["wycats/handlebars"],function(e){function t(e){return browser.extension.getURL(e)}function n(e,t,n){var r=e+t+n;return browser.extension.getURL(r)}return e.registerHelper("assetUrl",t),e.registerHelper("cardAssetUrl",n),{assetUrl:t,cardAssetUrl:n}}),ABINE_DNTME.define("abine/browserSyncStorage",["documentcloud/underscore","abine/core"],function(e,t){var n;n=browser&&browser.storage&&browser.storage.sync?t.BaseClass.extend({initialize:function(){},set:function(e,t){browser.storage.sync.set(e,t)},remove:function(e,t){browser.storage.sync.remove(e,t)},get:function(e,t){browser.storage.sync.get(e,t)},clear:function(e){browser.storage.sync.clear(e)}}):t.BaseClass.extend({initialize:function(){this.storage={}},set:function(t,n){e.extend(this.storage,t),n&&n()},remove:function(t,n){t="string"==typeof t?[t]:t,e.each(t,e.bind(function(e){delete this.storage[e]},this)),n&&n()},get:function(t,n){t="string"==typeof t?[t]:t,n&&n(e.pick(this.storage,t))},clear:function(e){this.storage={},e&&e()}});var r=new n({});return r}),ABINE_DNTME.define("documentcloud/backbone",["documentcloud/underscore","jquery"],function(){return Backbone}),ABINE_DNTME.define("wycats/handlebars",[],function(){var e={};e.VERSION="1.0.beta.6",e.helpers={},e.partials={},e.registerHelper=function(e,t,n){n&&(t.not=n),this.helpers[e]=t},e.registerPartial=function(e,t){this.partials[e]=t},e.registerHelper("helperMissing",function(e){if(2!==arguments.length)throw new Error("Could not find property '"+e+"'")});var t=Object.prototype.toString,n="[object Function]";return e.registerHelper("blockHelperMissing",function(e,r){var i=r.inverse||function(){},a=r.fn,o="",s=t.call(e);if(s===n&&(e=e.call(this)),e===!0)return a(this);if(e===!1||null==e)return i(this);if("[object Array]"===s){if(e.length>0)for(var l=0,c=e.length;l<c;l++)o+=a(e[l]);else o=i(this);return o}return a(e)}),e.registerHelper("each",function(e,t){var n=t.fn,r=t.inverse,i="";if(e&&e.length>0)for(var a=0,o=e.length;a<o;a++)i+=n(e[a]);else i=r(this);return i}),e.registerHelper("if",function(r,i){var a=t.call(r);return a===n&&(r=r.call(this)),!r||e.Utils.isEmpty(r)?i.inverse(this):i.fn(this)}),e.registerHelper("unless",function(t,n){var r=n.fn,i=n.inverse;return n.fn=i,n.inverse=r,e.helpers["if"].call(this,t,n)}),e.registerHelper("with",function(e,t){return t.fn(e)}),e.registerHelper("log",function(t){e.log(t)}),e.Exception=function(){var e=Error.prototype.constructor.apply(this,arguments);for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this.message=e.message},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()},function(){var t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=/&(?!\w+;)|[<>"'`]/g,r=/[&<>"'`]/,i=function(e){return t[e]||"&amp;"};e.Utils={escapeExpression:function(t){return t instanceof e.SafeString?t.toString():null==t||t===!1?"":r.test(t)?t.replace(n,i):t},isEmpty:function(e){return"undefined"==typeof e||(null===e||(e===!1||"[object Array]"===Object.prototype.toString.call(e)&&0===e.length))}}}(),e.VM={template:function(t){var n={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,n,r){var i=this.programs[t];return r?e.VM.program(n,r):i?i:i=this.programs[t]=e.VM.program(n)},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop};return function(r,i){return i=i||{},t.call(n,e,r,i.helpers,i.partials,i.data)}},programWithDepth:function(e,t){var n=Array.prototype.slice.call(arguments,2);return function(r,i){return i=i||{},e.apply(this,[r,i.data||t].concat(n))}},program:function(e,t){return function(n,r){return r=r||{},e(n,r.data||t)}},noop:function(){return""},invokePartial:function(t,n,r,i,a,o){if(options={helpers:i,partials:a,data:o},void 0===t)throw new e.Exception("The partial "+n+" could not be found");if(t instanceof Function)return t(r,options);if(e.compile)return a[n]=e.compile(t),a[n](r,options);throw new e.Exception("The partial "+n+" could not be compiled when running in runtime-only mode")}},e.template=e.VM.template,e}),ABINE_DNTME.define("duckbone/core",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars"],function(e,t){var n={};return n.helpers=n.helpers||{},n.forms=n.forms||{},n.TemplatesData=n.TemplatesData||{},n.PartialsData=n.PartialsData||{},e.extend(n,t.Events),e.extend(n,{serverError:function(t){e.log("500 Server Error"),t&&e.log(t)},fileNotFound:function(t){e.log("404 File Not Found"),t&&e.log(t)},register:function(t,r){r=r||!1;var i=e.uniqueId("regfunc");return e.isUndefined(n.registeredFunctions)&&(n.registeredFunctions={}),r&&(t=e.wrap(t,function(e){e(arguments),delete n.registeredFunctions[i]})),n.registeredFunctions[i]=t,"Duckbone.registeredFunctions."+i},wrapMethods:function(t,n){var r=Array.prototype.slice.call(arguments,2);e.isArray(r[0])&&(r=r[0]),e.each(r,function(e){var r=t[e];t[e]=function(){var e=[r].concat(Array.prototype.slice.call(arguments));return n.apply(t,e)}})},log:function(e){window.console&&console.log&&console.log(e)},include:function(t){if("undefined"==typeof t)throw"Attempt to include into undefined object.";return e.each(e.toArray(arguments).slice(1),function(e){if("undefined"==typeof e)throw"Attempt to include undefined object.";for(var n in e)"included"!=n&&void 0!==e[n]&&(t.hasOwnProperty(n)||(t[n]=e[n]));"function"==typeof e.included&&e.included.call(t)}),t}}),e.extend(n.helpers,{dateToPrettyTimeAgo:function(e){var t=Math.floor(((new Date).getTime()-e.getTime())/6e4);t<0&&(t=0);var n,r,i,a=t||0;return 0===a?"just now":(a>=1440?(r=Math.floor(a/1440),a-=1440*r,n=r,n+=r>1?" days":" day"):a>=60?(i=Math.floor(a/60),a-=60*i,n=i,n+=i>1?" hours":" hour"):a>0&&(n=a,n+=a>1?" minutes":" minute"),n+" ago")}}),e.mixin({log:n.log}),n}),ABINE_DNTME.define("duckbone/model",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars","duckbone/core","abine/eventLogger"],function(e,t,n,r,i){function a(n,r,a,o){var l=c("set_"+r),u=c(r),d=function(e,r){if(e instanceof t.Model){if(e===n[u])return e;n[u]&&(n.trigger("remove:"+u),o&&(n[u][o]=null)),n[u]=e,o&&s(n,n[u],o,r),n.trigger("add:"+u)}else if(e)if(n[u]){var i=function(){n.trigger("change:"+u)};n[u].on("change",i),n[u].set(e),n[u].off("change",i)}else n[u]=new a(e),o&&s(n,n[u],o,r),n.trigger("add:"+u);else n[u]&&(n.trigger("remove:"+u),o&&(n[u][o]=null)),n[u]=null;return e&&n.messenger&&!e.messenger&&(e.messenger=n.messenger),e};try{d.call(n,n.get(r),!0)}catch(e){i.error("Error creating association for "+r+":\n"+e)}delete n.attributes[r],n[l]=e.bind(d,n)}function o(e,t,n,r){try{var a=c(t),o=e.get(t),l=e[a]=new n(o);delete e.attributes[t],r&&(l[r]=e,l.each(function(t){s(e,t,r)}),l.on("add",function(t){s(e,t,r)}),l.on("remove",function(e){e[r]=null}),l.on("reset",function(t){t.each(function(t){s(e,t,r)})})),e.messenger&&!l.messenger&&(l.messenger=e.messenger)}catch(e){i.error("Error creating association for "+t+":\n"+e)}}function s(e,t,n,r){var a="set"+n.slice(0,1).toUpperCase()+n.slice(1);"function"==typeof t[a]?t[a].call(t,e,r):r?t[n]=e:i.error("To use belongsTo, model must define hasOne for "+n)}function l(n,r){var i={};return n instanceof t.Model||!this._associations?i=n:e(n).each(function(e,t){var n=this._associations[t];if("hasOne"==n){var r=c("set_"+t);this[r](e)}else if("hasMany"==n){var a=c(t);"function"==typeof this[a].freshen?this[a].freshen(e):this[a].reset(e)}else i[t]=e},this),this.setWithoutAssociations.call(this,i,r)}function c(e){return e.replace(/(\_[a-z])/g,function(e){return e.toUpperCase().replace("_","")})}function u(e){return e.replace(/^\w/,function(e){return e.toUpperCase()})}r.AssociableModel={isAssociableModel:!0,included:function(){this.setWithoutAssociations||(this.setWithoutAssociations=this.set,this.set=l)},hasOne:function(t){e.each(t,function(e,t){this._associations=this._associations||{},this._associations[t]="hasOne",a(this,t,e.model,e.belongsTo)},this)},hasMany:function(t){e.each(t,function(e,t){this._associations=this._associations||{},this._associations[t]="hasMany",o(this,t,e.collection,e.belongsTo)},this)}},r.ModelHelpers={simpleSave:function(e){var t={};this.id&&(e.id=this.id),this.paramRoot?t[this.paramRoot]=e:t=e;var n=JSON.stringify(t);return this.save({},{contentType:"application/json",data:n})},url:function(){var e="function"==typeof this.urlRoot?this.urlRoot():this.urlRoot,t=d(this.collection)||e||urlError();return this.isNew()?t:t+("/"==t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},setOne:function(e,t,n){var r={};return r[e]=t,this.set(r,n)},createGetters:function(){var t=this,n=arguments,r={};e.each(n,function(e){getterFuncName=c(e),getterFuncName="get"+u(getterFuncName),t[getterFuncName]||(r[getterFuncName]=function(){return this.get(e)})}),e.extend(this,r)},isValidAttribute:function(t){return!e.isNaN(t)&&!e.isUndefined(t)}};var d=function(t){return t&&t.url?e.isFunction(t.url)?t.url():t.url:null}}),ABINE_DNTME.define("duckbone/syncable",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){function a(t){return t&&t.url?e.isFunction(t.url)?t.url():t.url:null}function o(){throw new Error("A 'url' property or function must be specified")}function s(e){var t,n,r,i,a,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="",l="",c="",u=0;do t=e.charCodeAt(u++),n=e.charCodeAt(u++),l=e.charCodeAt(u++),r=t>>2,i=(3&t)<<4|n>>4,a=(15&n)<<2|l>>6,c=63&l,isNaN(n)?a=c=64:isNaN(l)&&(c=64),s=s+o.charAt(r)+o.charAt(i)+o.charAt(a)+o.charAt(c),t=n=l="",r=i=a=c="";while(u<e.length);return s}i.Syncable={isSyncable:!0,sync:function(n,r,u){var d,h=c[n],f=r.defaultSyncOptions||{},p=e.extend({type:h,dataType:"json",beforeSend:function(e){var n=t('meta[name="csrf-token"]').attr("content");n&&e.setRequestHeader("X-CSRF-Token",n)}},f,u);if(t.browser.msie&&(p.cache=!1),p.url||(p.url=a(r)||o()),!p.data&&r&&("create"==n||"update"==n)){p.contentType="application/json";var m={};r.paramRoot?m[r.paramRoot]=r.toJSON():m=r.toJSON(),p.data=JSON.stringify(m)}return"GET"!==p.type&&(p.processData=!1),l.username&&(p.username=l.username,p.password=l.password,p.headers=p.headers||{},p.headers.Authorization="Basic "+s(p.username+":"+p.password)),d=t.ajax(p),d.params=p,r.trigger("sync:"+n.toLowerCase()),d.complete(function(){r.trigger("sync:complete",d)}),d.success(function(){delete r.errors,r.trigger("sync:success",d)}),d.error(function(e){e.status>=400&&i.trigger("sync:"+e.status,d)}),d.error(function(e){if(422==e.status){var t=JSON.parse(e.responseText);t.errors?r.errors=t.errors:r.errors=t,r.trigger("sync:invalid",d)}else r.trigger("sync:error",d)}),d}},i.setAuthenticatedUser=function(e,t){l.username=e,l.password=t},i.removeAuthenticatedUser=function(){delete l.username,delete l.password};var l={},c={create:"POST",update:"PUT","delete":"DELETE",read:"GET"}}),ABINE_DNTME.define("duckbone/collection",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r){r.CollectionHelpers={hasDuckboneCollectionHelpers:!0,slice:function(){return this.models.slice(arguments)},toSelectOptions:function(e,t){var n={};return e=e||"title",t&&(n[" "]=" "),this.each(function(t){n[t.id]=t.get(e)}),n},freshen:function(t){var n;this.each(function(e){e._remove=!0}),e(t).each(function(e){n=this.get(e.id),n?(n.set(e),delete n._remove):this.add(e)},this);var r=this.filter(function(e){return e._remove});e(r).each(function(e){this.remove(e)},this),this.trigger("freshen",this)},fetch:function(e){e||(e={});var n=this,r=e.success;e.success=function(t,i,a){n[e.add?"add":e.freshen?"freshen":"reset"](n.parse(t,a),e),n.trigger("sync"),r&&r(n,t)};var i=e.error;return e.error=function(t){i?i(n,t,e):n.trigger("error",n,t,e)},(this.sync||t.sync).call(this,"read",this,e)}}}),ABINE_DNTME.define("duckbone/routeable_application",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){i.RouteableApplication={isRouteableApplication:!0,setContainer:function(e){this.mainContainer=e},mapRoutes:function(t){e.each(e.keys(t),function(n){try{var r=t[n].routeName||t[n].prototype.templateName;if(!r)throw"Missing or bad routeName for "+n;if("function"!=typeof t[n].routeAction)throw"Missing or bad routeAction for "+n;this.route(n,r,t[n].routeAction),this.route(n+"?*params",r,function(){var r=e.toArray(arguments),i=r.pop(),a=e(i.split("&")).reduce(function(e,t){return e[t.split("=")[0]]=t.split("=")[1],e},{});return t[n].routeAction.apply(this,r.concat(a))})}catch(t){throw e.log(t),"Bad route for "+n}},this)},loadView:function(e,n){return void 0===n&&(n={}),this._removableFlashes&&(this._removableFlashes.remove(),delete this._removableFlashes),this.mainView&&this.mainView.remove(),n.application=this,this.mainView=new e(n),t(this.mainView.el).appendTo(this.mainContainer),this.mainView},navigate:function(e,t){this.isFlashableView&&(this._removableFlashes=this.activeFlashes()),n.history.navigate(e,t)},bindNavigationBars:function(){this.on("all",function(e){if("route"==e.split(":")[0]){var n=e.split(":")[1];t("nav ul li").removeClass("active"),t("nav ul li."+n).addClass("active")}})}}}),ABINE_DNTME.define("duckbone/view_lifecycle_extensions",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){i.ViewLifecycleExtensions={hasViewLifecycleExtensions:!0,initialize:function(){this.application=this.options.application,this.messenger=this.options.messenger,this.isEditableView&&(a(this,"beforeClone"),this.cloneModelForEditing(),a(this,"afterClone")),this.render(),this.isStylizeableView&&this.applyStyles(),this.isBindableView&&this.bindAttributes(),this.isEditableView&&(this.bindModelSyncEvents(),this.createForm(),a(this,"afterCreateForm")),a(this,"afterInitialize")},render:function(){return this.isTemplateableView&&this.renderTemplate(),this.isStylizeableView&&this.applyStyles(),this},remove:function(){return this.isEditableView&&this.expireClone(),a(this,"beforeRemove"),this.removeWeakBindings(),this.isNestableView&&this.removeNestedViews(),n.View.prototype.remove.call(this),a(this,"afterRemove"),this},weakBindToModel:function(e,t,n){this.weakBindTo(this.model,e,t,n)},weakBindTo:function(t,n,r){this._weakBindings=this._weakBindings||[],this._weakBindings.push([t,n,r]),t.bind.apply(t,e.toArray(arguments).slice(1))},removeWeakBindings:function(){e.each(this._weakBindings,function(e){e[0].unbind(e[1],e[2])}),delete this._weakBindings,this.isBindableView&&this.unbindLiveTimestamps()}};var a=function(e,t){e[t]&&e[t].call(e)}}),ABINE_DNTME.define("duckbone/handlebars_extensions",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){ABINE_DNTME.Duckbone=i,i.Handlebars=r,r.getAttr=function(e,t){return/^[0-9]+$/.test(t)?e[parseInt(t)]:void 0!=e[t]?"function"==typeof e[t]?e[t].call(e):e[t]:e.get?e.get(t):void 0;
}}),ABINE_DNTME.define("duckbone/idme_template_registry",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){function a(t){t.templatesCompiled||(e.each(e.keys(ABINE_DNTME.CompiledTemplates),function(e){var n=e.replace("views/","").replace("/","_");t.compiledTemplates[n]=ABINE_DNTME.CompiledTemplates[e]}),t.templatesCompiled=!0)}i.TemplateRegistry=function(e){e=e||{},this.compiledTemplates={},this.templatesCompiled=!1,this.partialsCompiled=!1},e.extend(i.TemplateRegistry.prototype,{refresh:function(){},compile:function(){a(this)},get:function(e){return a(this),this.compiledTemplates[e]}})}),ABINE_DNTME.define("duckbone/nestable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){i.NestableView={isNestableView:!0,setupNestedViews:function(){this.createChildren&&(this.children=this.createChildren())},removeNestedViews:function(){this.children&&(e.each(this.children,function(e){e.remove()}),delete this.children)}}}),ABINE_DNTME.define("duckbone/templateable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core","abine/eventLogger"],function(e,t,n,r,i,a){var o=new i.TemplateRegistry;r&&(r.helpers.oldIf=r.helpers["if"],r.registerHelper("if",function(e,t,n){var i="function"==typeof e?e.call(this):e;return r.helpers.oldIf.call(this,i,t,n)}),r.registerHelper("attr",function(e){return new r.SafeString('<span data-bind="attr_'+r.Utils.escapeExpression(e)+'">'+r.Utils.escapeExpression(this.get(e))+"</span>")}),r.registerHelper("child",function(t,n){return n=e.isObject(n)?"div":n,new r.SafeString("<"+n+' data-child-view="'+r.Utils.escapeExpression(t)+'"></'+n+">")}),r.helpers.oldEach=r.helpers.each,r.registerHelper("each",function(e,t,n){return e.models&&(e=e.models),r.helpers.oldEach.call(this,e,t,n)})),i.TemplateableView={isTemplateableView:!0,included:function(){this.hasViewLifecycleExtensions||i.include(this,i.ViewLifecycleExtensions),this.isNestableView||i.include(this,i.NestableView)},templateRegistry:o,getTemplate:function(e,t){if(this.templateData=this.options.templateData||this.templateData||null,this.templateData)throw a.error("Cannot compile template."),"Cannot compile template";return e=e||this.options.templateName||this.templateName||"",this.template=this.templateRegistry.get(e),this.template||t||(this.template=i.Handlebars.compile('<div>Missing Template "'+e+'"</div>')),this.template},renderTemplate:function(i){var i=i||this.model||{};if(e.isFunction(this.options.template)?this.template=this.options.template:this.template||this.getTemplate(),!this.template)throw"renderTemplate called without a template.";this.removeNestedViews(),this.isBindableView&&this.unbindAttributes();try{t(this.el).empty().html(this.template(i))}catch(e){a.error("Handlebars threw an exception rendering your template:"),a.error(e.message),a.error("Context:"),a.error(i),t(this.el).html('<div class="duckbone_error">Handlebars exception: '+r.Utils.escapeExpression(e.message)+"</div>")}this.isBindableView&&i instanceof n.Model&&t(this.el).find("span[data-bind]").each(e.bind(function(e,n){var r=t(n).attr("data-bind").slice(5),a='span[data-bind="attr_'+r+'"]';this.bindAttribute(i,r,a)},this)),this.setupNestedViews(),t(this.el).find("*[data-child-view]").each(e.bind(function(e,r){var i=t(r).attr("data-child-view"),o=this.children[i];o instanceof n.View?(t(r).replaceWith(o.el),t(o.el).attr({"data-child-view":i}),o.delegateEvents()):a.error("Unknown child view "+i)},this));this.options.templateName||this.templateName;return this.templateName&&t(this.el).addClass(this.templateName),this.templateRendered=!0,this},renderTemplateOnce:function(e){return this.templateRendered||this.renderTemplate(e),this}}}),ABINE_DNTME.define("duckbone/stylizeable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){i.StylizeableView={isStylizeableView:!0,included:function(){this.hasViewLifecycleExtensions||i.include(this,i.ViewLifecycleExtensions)},applyStyles:function(e){e=e||this.styles||{};var n,r;for(var i in e)n=i.split(".")[0],r=i.split(".")[1],"el"==i?t(this.el).css(e.el):"el"==n&&r&&t(this.el).hasClass(r)?t(this.el).css(e[i]):t(this.el).find(i).css(e[i])}}}),ABINE_DNTME.define("duckbone/pageable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){i.PageableView={isPageableView:!0,included:function(){this.isTemplateableView||i.include(this,i.TemplateableView)},getTemplate:function(e){i.TemplateableView.getTemplate.call(this,e,!0),this.template=this.template||i.Handlebars.compile('{{child "list"}}{{child "pager"}}')},createChildren:function(){var t=this.createListView(),n=this.createPagerView();return this.application=this.options.application||this.application,this.application&&this.collection.on("pageChange",function(t,n){var r=window.location.hash.split("?")[0]+"?",i=e(e.keys(n)).map(function(e){return e+"="+n[e]}).join("&");r+=i,this.application.navigate(r,!1)},this),{list:t,pager:n}},createListView:function(){return new i.ListView({viewClass:this.viewClass,pageableView:this,tagName:"ul",className:"listable_view",collection:this.collection})},createPagerView:function(){var e=this.options.pagerClass||this.pagerClass||Pager;return new e({collection:this.collection,pageableView:this})},showPage:function(e){e=parseInt(e)||1,this.collection.setPage(e)},showNextPage:function(){this.showPage(this.collection.currentPage+1)},showPreviousPage:function(){this.showPage(this.collection.currentPage-1)},scrollToTopOfList:function(){var e=t(this.children.list.el).offset().top-20;t("html body").animate({scrollTop:e},400,"swing")}};var a='<div class="pager">&nbsp;<br/>    {{#if showPrevious}}      <a href="#" class="previous_link">&laquo;&nbsp;Previous</a>&nbsp;    {{else}}      <span class="inactive">&laquo;&nbsp;Previous</span>&nbsp;    {{/if}}    {{#each pages}}      {{#if currentPage}}        <span class="current">{{title}}</span>&nbsp;      {{else}}        <a href="#" class="page_link" data-page="{{id}}">{{title}}</a>&nbsp;      {{/if}}    {{/each}}    {{#if showNext}}      <a href="#" class="next_link">Next&nbsp;&raquo;</a>    {{else}}      <span class="inactive">Next&nbsp;&raquo;</span>    {{/if}}  </div>';Pager=n.View.extend({el:'<div class="pager_view"></div>',templateData:a,events:{"click a.previous_link":"showPreviousPage","click a.next_link":"showNextPage","click a.page_link":"showPage"},initialize:function(){this.render(),this.collection.on("all",this.render,this)},render:function(){return this.collection.numPages&&this.renderTemplate(this.paginationData()),this.collection.numPages>1?t(this.el).show():t(this.el).hide(),this},paginationData:function(){var t=this.collection.numPages,n={showPrevious:this.collection.currentPage>1,numPages:t,showNext:this.collection.currentPage<this.collection.numPages,pages:e(e.range(1,t+1)).map(function(e){return{id:e,title:""+e,currentPage:e==this.collection.currentPage}},this)};return n},showPage:function(e){e.preventDefault();var n=parseInt(t(e.target).data("page"));return this.options.pageableView.showPage(n),this.options.pageableView.scrollToTopOfList(),!1},showPreviousPage:function(e){return e.preventDefault(),this.options.pageableView.showPreviousPage(),this.options.pageableView.scrollToTopOfList(),!1},showNextPage:function(e){return e.preventDefault(),this.options.pageableView.showNextPage(),this.options.pageableView.scrollToTopOfList(),!1}}),i.include(Pager.prototype,i.TemplateableView)}),ABINE_DNTME.define("duckbone/pageable_collection",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){function a(e,t){t=t||{};var n="function"==typeof e.url?e.url():e.url;n.indexOf("?")<0&&(n+="?");for(var r in t)n+=r+"="+t[r]+"&";return n}i.PageableCollection={isPageableCollection:!0,parse:function(e){return this.numPages=e.num_pages,this.limitValue=e.limit_value,this.currentPage=e.current_page,this.totalCount=e.total_count,e.records},fetch:function(){this.fetchPage(1)},fetchPage:function(t,r){return t=t||1,r=r||e.clone(this.params)||{},n.Collection.prototype.fetch.call(this,{url:a(this,e.extend(r,{page:t})),success:function(e){e.trigger("pageChange",e.currentPage,r)}})},setParam:function(e,t){this.params=this.params||{},this.params[e]=t},setPage:function(e){if(e!=this.currentPage&&e>0&&e<=this.numPages)return this.fetchPage(e)},nextPage:function(){return this.fetchPage(this.currentPage+1)},prevPage:function(){return this.fetchPage(this.currentPage-1)},updateTotalCountOnCollectionEvents:function(){this.on("add",function(){this.totalCount&&(this.totalCount+=1)},this),this.on("remove",function(){this.totalCount&&(this.totalCount-=1)},this)}}}),ABINE_DNTME.define("duckbone/bindable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){i.BindableView={isBindableView:!0,included:function(){this.hasViewLifecycleExtensions||i.include(this,i.ViewLifecycleExtensions)},bindAttributes:function(e){if(this.attributeChanges){e=e||this.model||new n.Model;for(var t in this.attributeChanges)this.bindAttribute(e,t,this.attributeChanges[t])}},bindAttribute:function(e,i,a){e=e||this.model||new n.Model;var o,s=r.Utils.escapeExpression(e.get(i));"function"==typeof a?(a.call(this,s),o=function(){a.call(this,r.Utils.escapeExpression(e.get(i)))}):"string"==typeof a&&(t(this.el).find(a).html(s),o=function(){t(this.el).find(a).html(r.Utils.escapeExpression(e.get(i)))}),this._attributeBindings=this._attributeBindings||[];var l="change:"+i;this._attributeBindings.push([e,l,o]),this.weakBindTo(e,l,o,this)},unbindAttributes:function(){this._attributeBindings&&(e(this._attributeBindings).each(function(e){e[0].unbind(e[1],e[2])}),delete this._attributeBindings)},bindLiveTimestamps:function(e){return},unbindLiveTimestamps:function(){}},r&&r.registerHelper("live_timestamp",function(e){var t=i.Handlebars.getAttr(this,e);if(!t)return"";var n=new Date(t);return n?new r.SafeString('<span data-live-timestamp="'+n.getTime()+'">'+i.helpers.dateToPrettyTimeAgo(n)+"</span>"):""})}),ABINE_DNTME.define("duckbone/listable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){function a(e){e.viewClass=e.options.viewClass||e.viewClass||new n.View}function o(e){e.collection=e.options.collection||e.collection||new n.Collection}i.ListableView={isListableView:!0,tagName:"ul",className:"listable_view",included:function(){this.hasViewLifecycleExtensions||i.include(this,i.ViewLifecycleExtensions),this.isBindableView||i.include(this,i.BindableView),this.isNestableView||i.include(this,i.NestableView)},render:function(e){return this.doc=this.doc||this.options.doc||document,this._viewsRendered&&!e||(this.renderItems(),this.collectionEventsBound||(this.bindCollectionEvents(),this.collectionEventsBound=!0),this._viewsRendered=!0),this},createChildren:function(){return e.reduce(this.collection.models,function(e,t){return e[t.cid]=new this.viewClass({model:t,doc:this.doc}),e},{},this)},renderItems:function(){a(this),o(this),this.setupNestedViews();var t=this.doc.createDocumentFragment();e.each(this.children,function(e){t.appendChild(e.el)}),this.el.appendChild(t)},bindCollectionEvents:function(e){var t;o(this),e=e||this.collectionEvents||s;for(var n in e){if(t=e[n],"string"==typeof t&&(t=this[t]),"function"!=typeof t)throw"Duckbone.ListableView.bindCollectionEvents() called with bad handler for "+n;this.weakBindTo(this.collection,n,t,this)}},refresh:function(e){e=e||{},this.empty(),this.collection.fetch()},getViewByModel:function(e){return this.children[e.cid]},collectionReset:function(){this.removeNestedViews(),this.render(!0)},collectionAdd:function(n){var r=new this.viewClass({model:n,doc:this.doc});this.children[n.cid]=r;var i=e(this.collection.models).indexOf(n);if(0==i)t(this.el).prepend(r.el);else{var a=t(this.el).children().eq(i-1);t(a).after(r.el)}},collectionRemove:function(e){this.children[e.cid].remove(),delete this.children[e.cid]}};var s={reset:"collectionReset",add:"collectionAdd",remove:"collectionRemove"}}),ABINE_DNTME.define("duckbone/flashable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){i.FlashableView={isFlashableView:!0,configureFlash:function(t){if(!t.container)throw"configureFlash called without a container";var n={noticeDuration:1e4,fadeDuration:300};this.flashOptions=e.extend(n,t),a.fadeDuration=this.flashOptions.fadeDuration,t.noticeTemplate&&"string"==typeof t.noticeTemplate?s.prototype.templateData=t.noticeTemplate:"function"==typeof t.noticeTemplate&&(s.prototype.template=t.noticeTemplate),t.errorTemplate&&"string"==typeof t.errorTemplate?FlashErrorView.prototype.templateData=t.errorTemplate:"function"==typeof t.errorTemplate&&(FlashErrorView.prototype.template=t.errorTemplate)},flashNotice:function(e,n){n=n||1e4;var r=new s({model:{message:e},duration:n});return t(this.flashOptions.container).append(r.el),t(r.el).hide().slideDown(300),r},flashAlert:function(e){var n=new l({model:{message:e}});return t(this.flashOptions.container).append(n.el),t(n.el).hide().slideDown(300),n},activeFlashes:function(){return t(this.flashOptions.container).find("div.flash_notice, div.flash_alert")},clearFlashes:function(e){if(this.flashOptions){var t=this.activeFlashes();e?t.remove():t.fadeOut(this.flashOptions.fadeDuration)}}};var a=n.View.extend({events:{"click a.close":"dismiss"},fadeDuration:300,dismiss:function(n){return n&&n.preventDefault(),t(this.el).fadeOut(this.fadeDuration),e.delay(e.bind(this.remove,this),this.fadeDuration),!1}});i.include(a.prototype,i.TemplateableView);var o='<div class="message">{{{message}}}</div>     <div class="close"><a href="#" class="close">X</a></div>',s=a.extend({className:"flash_notice",templateData:o,afterInitialize:function(){this.options.duration&&e.delay(e.bind(this.dismiss,this),this.options.duration)}}),l=a.extend({className:"flash_alert",templateData:o})}),ABINE_DNTME.define("duckbone/bindable_field",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){function a(e,t,n,r){r=r||!1,"undefined"==typeof n&&(n=null),i.ModelHelpers.setOne.call(e,t,n,{silent:r})}i.BindableField={isBindableField:!0,get:function(){var e=this.domToModelTransform(t(this.el).val());return this.stripWhitespace&&this.options.stripWhitespace!==!1&&(e=e.replace(/^\s+|\s+$/g,"")),e},set:function(e){t(this.el).val(this.modelToDomTransform(e))},modelToDomTransform:function(e){return void 0!==e||NaN!==e?e:""},domToModelTransform:function(e){return e},bindToModel:function(e){if(e=e||this.options.modelAttribute||this.modelAttribute||this.options.name||this.name,!e)throw"Duckbone.BindableField.bindToModel() called without a modelAttribute";this.modelAttribute=e;var t=this,n=this.model,r="change:"+e;t.form.view.weakBindToModel(r,function(){var r=n.get(e);r!==t.get()&&i.ModelHelpers.isValidAttribute(r)&&t.set(r)}),t.set(n.get(e))},bindToDOM:function(e,n,r){if(e=e||this.options.modelAttribute||this.modelAttribute||this.options.name||this.name,!e)throw"Duckbone.BindableField.bindToDOM() called without a modelAttribute";this.modelAttribute=e;var n=this.options.changeEvent||this.changeEvent||"change";r=r||this.el;var i=this,o=this.model;t(r).bind(n,function(){a(o,e,i.get())}),a(o,e,i.get())}}}),ABINE_DNTME.define("duckbone/validateable_field",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){i.ValidateableField={isValidateableField:!0,bindValidation:function(e,n){var r=this.options.validate||this.options.required;if(r){var i=this;e=e||this.options.validateEvent||"change",n=n||this.el;var a=t(window),o=null,s=function(){o=new Date},l=function(){a.unbind("mouseup",l),i.validate()};this.form.view&&this.form.view.isBindableView?this.form.view.weakBindTo(a,"mousedown",s):a.bind("mousedown",s),t(n).bind(e,function(){o&&new Date-o<10?a.bind("mouseup",l):i.validate()})}},validate:function(e,t){if(t=t||!1,t||this.clearErrors(),this.valid=!0,!this.options.validate&&this.options.required&&(this.options.validate="required",this.options.invalidMessage=this.options.invalidMessage||"Required"),e=e||this.options.validate,"string"==typeof e&&(e=i.forms.validators[e]),!e)return!0;var n=this.options.invalidMessage||"Invalid";if(0==e.call(this,this.get())&&(this.valid=!1),this.valid||t){var r=this.get();i.ModelHelpers.isValidAttribute(r)&&this.set(r)}else this.addError(n);return this.valid},addError:function(e){if(!this.errorList){this.errorList=t("<ul>").addClass("error");var n=t(this.el).parents("form").find("div."+this.name+"_errors").get(0);n?t(n).append(this.errorList):t(this.el).after(this.errorList)}this.errorList.append(t("<li>").html(e))},clearErrors:function(){this.errorList&&(this.errorList.remove(),this.errorList=null)}}}),ABINE_DNTME.define("duckbone/form_fields",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core","abine/intl"],function(e,t,n,r,i,a){r.registerHelper("form",function(e,t){var n=e;return n=n.replace(/^(new_)(.*)/,"$2").replace(/^(edit_)(.*)/,"$2"),n!=e&&(n+=" "+e),'<form action="#" name="'+e+'" class="'+n+'">\n'+t(this)+"\n</form>"}),r.registerHelper("form_error_banner",function(e){return e="string"==typeof e?e:"mm_duckbone_default_form_error",e=a.getText(e),new r.SafeString('<div class="error_banner alert alert-error" style="display: none">'+r.Utils.escapeExpression(e)+"</div>")}),r.registerHelper("form_error",function(e){return new r.SafeString('<div class="'+r.Utils.escapeExpression(e)+'_errors"></div>')}),r.registerHelper("form_label",function(e,t){var n;return"object"==typeof t?(n=e,n=n.replace(/^(.)/,function(e){return e.toUpperCase()}),n=n.replace(/(\_[a-z])/g,function(e){return e.toUpperCase().replace("_"," ")})):n="function"==typeof t?new r.SafeString(t(this)):a.getText(t),new r.SafeString('<label data-field-name="'+r.Utils.escapeExpression(e)+'">'+r.Utils.escapeExpression(n)+"</label>")}),r.registerHelper("form_text",function(e){return new r.SafeString('<input class="form_text" type="text" name="'+r.Utils.escapeExpression(e)+'"/>')}),r.registerHelper("form_select",function(e){return new r.SafeString('<select class="form_select" name="'+r.Utils.escapeExpression(e)+'"></select>')}),r.registerHelper("form_radio_set",function(e){return new r.SafeString('<div class="form_radio_set" name="'+r.Utils.escapeExpression(e)+'"></div>')}),r.registerHelper("form_checkbox",function(e){return new r.SafeString('<input class="form_checkbox" type="checkbox" name="'+r.Utils.escapeExpression(e)+'"/>')}),r.registerHelper("form_textarea",function(e){return new r.SafeString('<textarea class="form_textarea" name="'+r.Utils.escapeExpression(e)+'"></textarea>')}),r.registerHelper("form_password",function(e){return new r.SafeString('<input class="form_password" type="password" name="'+r.Utils.escapeExpression(e)+'"></input>')}),r.registerHelper("form_submit",function(e,t){return"undefined"==typeof t&&(t="mm_duckbone_default_form_submit_text"),"object"==typeof t&&(t="mm_duckbone_default_form_submit_text"),t=a.getText(t),new r.SafeString('<button class="form_submit" name="'+r.Utils.escapeExpression(e)+'">'+r.Utils.escapeExpression(t)+"</button>")}),r.registerHelper("form_submit_with_spinner",function(e,t,n){n="object"==typeof n?"/pages/images/ajax_loader.gif":n,"undefined"==typeof t&&(t="mm_duckbone_default_form_submit_text"),"object"==typeof t&&(t="mm_duckbone_default_form_submit_text"),t=a.getText(t);var i='<button class="form_submit" name="'+r.Utils.escapeExpression(e)+'">'+r.Utils.escapeExpression(t)+"</button>";return i+='<img src="'+r.Utils.escapeExpression(n)+'" class="ajax_loading '+r.Utils.escapeExpression(e)+'_loading" style="display: none"/>',new r.SafeString(i)}),i.FormFieldBase=n.View.extend(),e.extend(i.FormFieldBase.prototype,i.BindableField,i.ValidateableField,{initialize:function(e){this.name=this.options.name||t(this.el).attr("name"),this.form=this.options.form,e.elAttributes&&t(this.el).attr(e.elAttributes),this.afterInitialize(e),this.createChildren(),this.bindToModel(),this.bindToDOM(),this.bindValidation()},afterInitialize:function(){},createChildren:function(){}}),i.TextFormField=i.FormFieldBase.extend({type:"text",stripWhitespace:!0}),i.SelectFormField=i.FormFieldBase.extend({type:"select",createChildren:function(){var e=this.options.selectOptions,n="function"==typeof e?e.call(this):e;for(var i in n){var a=t("<option></option>").attr({value:i});a.html(r.Utils.escapeExpression(n[i])),t(this.el).append(a)}}}),i.RadioSetFormField=i.FormFieldBase.extend({type:"radio_set",createChildren:function(){var e=this.options.selectOptions,n="function"==typeof e?e.call(this):e;for(var i in n){var a=this.form.name+"_"+this.name+"_"+i,o=t('<div><input type="radio"/><label for="'+a+'" class="radio_label"></label></div>');t(o).find("input").attr({id:a,name:this.name,value:i}),t(o).find("label").html(r.Utils.escapeExpression(this.options.selectOptions[i])),t(this.el).append(o)}var s=this.el;t(this.el).find("input").bind("change",function(){t(s).trigger("change")})},get:function(){return t(this.el).find("input:checked").attr("value")},set:function(e){var n=t(this.el).find("input:checked").get(0);n&&(n.checked=!1);var r=t(this.el).find('input[value="'+e+'"]').get(0);r&&(r.checked=!0)}}),i.CheckboxFormField=i.FormFieldBase.extend({type:"checkbox",get:function(){return t(this.el).is(":checked")},set:function(e){t(this.el).attr({checked:e})}}),i.TextAreaFormField=i.FormFieldBase.extend({type:"textarea",stripWhitespace:!0}),i.PasswordFormField=i.FormFieldBase.extend({type:"password"}),i.SubmitFormField=n.View.extend(),e.extend(i.SubmitFormField.prototype,i.BindableField,{type:"submit",initialize:function(n){this.form=n.form,this.name=n.name,this.spinnerEl=t(this.el).next("img.ajax_loading"),t(this.el).bind("click",e.bind(this.bindDisableAndSpin,this)),this.submitForm="undefined"==typeof n.submitForm||n.submitForm},bindDisableAndSpin:function(e){e.preventDefault(),this.form.model.off("sync:create",this.disableAndSpin),this.form.model.off("sync:update",this.disableAndSpin),this.form.model.on("sync:create",this.disableAndSpin,this),this.form.model.on("sync:update",this.disableAndSpin,this),this.submitForm&&this.form.submit()},disableAndSpin:function(){this.form.model.off("sync:create",this.disableAndSpin),this.form.model.off("sync:update",this.disableAndSpin),this.spinnerEl&&t(this.spinnerEl).fadeIn(),t(this.el).addClass("loading"),t(this.el).unbind("click"),t(this.el).bind("click",this.stealClick),this.form.model.on("sync:complete",this.syncComplete,this)},stealClick:function(e){return e.preventDefault(),!1},syncComplete:function(){t(this.el).unbind("click"),t(this.el).removeClass("loading"),this.spinnerEl&&t(this.spinnerEl).fadeOut(),t(this.el).bind("click",e.bind(this.bindDisableAndSpin,this))}}),i.forms.fieldTypes={text:i.TextFormField,select:i.SelectFormField,radio_set:i.RadioSetFormField,checkbox:i.CheckboxFormField,textarea:i.TextAreaFormField,password:i.PasswordFormField,submit:i.SubmitFormField}}),ABINE_DNTME.define("duckbone/editable_view",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){function a(e,t){for(var n in t){var r=e[t[n]];"function"==typeof r&&e.weakBindToModel(n,r,e)}}function o(e,t){return e.name+"_"+t.name}function s(e){return"[name="+e+"]"}function l(e){var n=/^form_(.*)/.exec(t(e).attr("class"))[1];return i.forms.fieldTypes[n]}function c(e){var n=t(e).offset().top;n=n>p?n-p:0,t("html body").animate({scrollTop:n},h,f)}i.EditableView={isEditableView:!0,included:function(){this.hasViewLifecycleExtensions||i.include(this,i.ViewLifecycleExtensions)},createForm:function(e){e=e||{};var r=e.el||t(this.el).find("form").get(0)||t(this.el).get(0),a=e.fields||this.options.fields||this.fields,o=e.model||this.model,s=new i.FormManager({el:r,fields:a,model:o||new n.Model,view:this});return this.form=this.form||s,s},bindModelSyncEvents:function(){a(this,d),this.modelSyncEvents&&a(this,this.modelSyncEvents)},cloneModelForEditing:function(){if(!this.model)throw"Found not, has your model been. Cloned, it can not be.";this.originalModel=this.model,this.model=this.originalModel.clone(),this.weakBindToModel("sync:success",function(){var t=e.clone(this.model.attributes);e(this.form.fields).each(function(e){e.options.temporary&&delete t[e.modelAttribute]}),this.originalModel.set(t),u.call(this)},this)},expireClone:function(){if(this.originalModel){this.model.clear({silent:!0});var e=function(){throw"Attempted get/set on expired clone from Duckbone.EditableView. Use original model instead."};this.model.set=e,this.model.get=e,this.model=this.originalModel,delete this.originalModel}},resetModel:function(){if(!this.originalModel)throw"Cloned not, has your model been. Reset, we can not do.";this.model.set(this.originalModel.attributes)},defaultModelSyncSavingHandler:function(){t(this.el).find("div.error_banner").hide(),e.each(this.form.fields,function(e){e.isValidateableField&&e.clearErrors()},this)},defaultModelSyncInvalidHandler:function(){t(this.el).find("div.error_banner").show(),e.each(this.model.errors,function(t,n){var r=this.form.getFieldForModelAttribute(n);e.each(this.model.errors[n],function(t){r&&r.isValidateableField?r.addError(t):e.log("Cannot add error for field "+n+": "+t)},this)},this),t(this.el).find("div.error_banner").show(),c(this.el)},defaultModelSyncSuccessHandler:function(){},defaultModelSyncErrorHandler:function(){},defaultModelSyncCompleteHandler:function(){}},i.FormManager=function(r){this.el=r.el||t('<form action="#"></form>').get(0),this.fieldOptions=e.clone(r.fields)||{},this.model=r.model||new n.Model({}),this.view=r.view,this.name=t(this.el).attr("name")||"untitled_form",this.createFields()},e.extend(i.FormManager.prototype,n.Events),e.extend(i.FormManager.prototype,{createFields:function(){var e,n,r=this;for(n in this.fieldOptions)e=this.createField(n,this.fieldOptions[n]);t(this.el).find("button.form_submit").each(function(){n=t(this).attr("name"),r.fields[n]||(e=new i.forms.fieldTypes.submit({name:n,el:this,form:r}),r.fields[e.name]=e)}),t(this.el).find("label").each(function(){var e=t(this).attr("data-field-name");e&&r.fields[e]&&t(this).attr("for",o(r,r.fields[e]))})},createField:function(n,r){this.fields=this.fields||{};var a,c,u;if(a=t(this.el).find(s(n)).get(0),!a)throw"Form field "+n+" defined in view, missing in template";if(c=r.type?i.forms.fieldTypes[r.type]:l(a),!c)throw"Bad form field type "+n;return u=new c(e.extend(r,{el:a,model:this.model,form:this,name:n})),u.name=n,t(u.el).attr("id",o(this,u)),this.fields[n]=u,u},getField:function(e){return this.fields[e]},getFieldForModelAttribute:function(t){return e.detect(this.fields,function(e){return e.modelAttribute==t},this)},validate:function(){this.isValid=!0;var e;for(var t in this.fields)e=!this.fields[t].validate||this.fields[t].validate(),e||(this.isValid=!1);return this.isValid},submit:function(n){this.validate()?(n=e.clone(n)||{},e.each(["success","error"],function(t){if("function"==typeof n[t]){var r=n[t];n[t]=function(t,n){e.defer(e.bind(r,t,t,n))}}},this),this.model.save(null,n)):(e.log("Form is invalid."),t(this.el).find("div.error_banner").show(),c(this.el))}});var u=function(){var t=this.options.afterSaveDestination||this.afterSaveDestination;t&&(t instanceof Array||(t=[t]),e.each(t,function(e){if(e.collection)e.collection.add(this.originalModel);else{var t="set"+e.association.slice(0,1).toUpperCase()+e.association.slice(1);e.model[t].call(e.model,this.originalModel)}},this))},d={"sync:create":"defaultModelSyncSavingHandler","sync:update":"defaultModelSyncSavingHandler","sync:success":"defaultModelSyncSuccessHandler","sync:invalid":"defaultModelSyncInvalidHandler","sync:error":"defaultModelSyncErrorHandler","sync:complete":"defaultModelSyncCompleteHandler"},h=400,f="swing",p=100}),ABINE_DNTME.define("duckbone/form_validations",["documentcloud/underscore","jquery","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r,i){i.forms=i.forms||{},i.forms.validators=i.forms.validators||{},e.extend(i.forms.validators,{required:function(e){return!(void 0==e||null==e||""==e)},USPhone:function(e){return/^\(?(\d{3})\)?[\- ]?\d{3}[\- ]?\d{4}$/.test(e)},date:function(e){return/^(?:0?[1-9]|1[0-2])\/(?:0?[1-9]|[12][0-9]|3[01])\/\d{2}?\d{2}$/.test(e)},email:function(e){return/^([A-Za-z0-9\._%\+\-]+)@([A-Za-z0-9\-]+\.)+([A-Za-z]{2,})$/.test(e)},numeric:function(e){return NaN!=parseFloat(e)}})}),ABINE_DNTME.define("duckbone/simple_queue",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars","duckbone/core"],function(e,t,n,r){r.SimpleQueue=function(e){this.interval=e.interval||400,this.elements=[],this.callback=e.callback,this.running=!1},e.extend(r.SimpleQueue.prototype,{push:function(t){this.elements.push(t),this.comparator&&e(this.elements).sortBy(this.comparator),this.running||(this.running=!0,this.timer=setInterval(e.bind(this.shift,this),this.interval))},shift:function(){if(0==this.elements.length)this.running=!1,clearInterval(this.timer);else{var e=this.elements.shift();this.callback.call(e,e,this)}}})}),ABINE_DNTME.define("duckbone/base_classes",["documentcloud/underscore","documentcloud/backbone","wycats/handlebars","duckbone/core","jquery","abine/timer"],function(e,t,n,r,i,a){r.Model=t.Model.extend(),r.include(r.Model.prototype,r.AssociableModel,r.ModelHelpers,r.Syncable),r.Collection=t.Collection.extend(),r.include(r.Collection.prototype,r.CollectionHelpers,r.Syncable),r.View=t.View.extend(),r.include(r.View.prototype,r.TemplateableView,r.BindableView),r.View.prototype.transferEvents=function(t,n){e.each(t,e.bind(function(t){"resize"!=t?this.on(t,function(e,r){n.trigger.apply(n,[t,e,r])}):this.on(t,function(r){a.setTimeout(e.bind(function(){n.trigger.apply(n,[t,r])},this),50)})},this))},t.View.prototype.make=function(e,t,n){var r=(this.doc||this.options.doc||document).createElement(e);return t&&i(r).attr(t),n&&i(r).html(n),r},r.FormView=r.View.extend(),r.include(r.FormView.prototype,r.EditableView),r.ListView=t.View.extend(),r.include(r.ListView.prototype,r.ListableView,r.BindableView),r.Application=t.Router.extend(),r.include(r.Application.prototype,r.RouteableApplication,r.FlashableView)}),ABINE_DNTME.define("duckbone/security",["documentcloud/underscore","jquery","duckbone/core"],function(e,t,n){function r(e,t,n){if(!e._unlockHooked){e._unlockHooked=!0;var r=function(){i(e,t,n)};ABINE_DNTME.App.on("unlocked",r),t.prototype._oldBeforeRemove=t.prototype.beforeRemove,t.prototype.beforeRemove=function(){t.prototype.beforeRemove=t.prototype._oldBeforeRemove,t.prototype.beforeRemove&&t.prototype.beforeRemove.apply(e,arguments),e._unlockHooked=!1,ABINE_DNTME.App.off("unlocked",r)}}}function i(e,t,n){return ABINE_DNTME.App.isLocked()?(r(e,t,n),e):void t.prototype._oldRender.apply(e,n)}function a(e,t){ABINE_DNTME.App.isLocked()?ABINE_DNTME.App.renderPage():e._oldRouteAction.apply(e,t)}n.Security={showBlankWhenLocked:function(e){e.prototype._oldRender=e.prototype.render,e.prototype.render=function(){i(this,e,arguments)}},showLoginWhenLocked:function(e){e._oldRouteAction=e.routeAction,e.routeAction=function(){a(e,arguments)}}}}),ABINE_DNTME.requireDuckbone=function(e){ABINE_DNTME.require(["duckbone/core","duckbone/model","duckbone/syncable","duckbone/collection","duckbone/routeable_application","duckbone/view_lifecycle_extensions","duckbone/handlebars_extensions","duckbone/idme_template_registry","duckbone/nestable_view","duckbone/templateable_view","duckbone/stylizeable_view","duckbone/pageable_view","duckbone/pageable_collection","duckbone/bindable_view","duckbone/listable_view","duckbone/flashable_view","duckbone/bindable_field","duckbone/validateable_field","duckbone/form_fields","duckbone/editable_view","duckbone/form_validations","duckbone/simple_queue","duckbone/base_classes"],function(){e()})},ABINE_DNTME.define("models",[],function(){return{}}),ABINE_DNTME.requireModels=function(e){ABINE_DNTME.require(["abine/models/base","abine/models/blacklist","abine/models/disposableCard","abine/models/disposableEmail","abine/models/disposablePhone","abine/models/dntStats","abine/models/preference","abine/models/autofillFeedback","abine/models/mappedForm","abine/models/pageData","abine/models/mappedField","abine/models/mappingMenu","abine/models/shieldedCard","abine/models/shieldedEmail","abine/models/shieldedPhone","abine/models/tabData","abine/models/address","abine/models/account","abine/models/identity","abine/models/realCard","abine/models/globalData","abine/models/feedback","abine/models/trackerInfo","abine/models/advt","abine/models/extensionVersion","abine/models/loginUrl"],function(){
e()})},ABINE_DNTME.define("abine/models/base",["abine/contentMessenger","documentcloud/backbone","duckbone/core","models"],function(e,t,n,r){function i(){return a||(a=ABINE_DNTME.contentMessenger||new e.ContentMessenger({messengerId:"model"})),a}var a,o=function(e,t,n){var r,a,o,s=n.payload||{};!t||"create"!=e&&"update"!=e||(s=t.toJSON(),delete s.messenger),n.eventName?r=n.eventName:(r=t.model?e+":"+t.model.storageEntity:e+":"+t.storageEntity,"create"!=e&&(r+=":"+t.id)),a="response:"+r.split(":").slice(1).join(":"),o="error:"+r.split(":").slice(1).join(":");var l=t.messenger;!l&&t.collection&&t.collection.messenger&&(l=t.collection.messenger),l||(l=i());var c=function(e){l.off(a,c),l.off(o,u),delete t.errors,n.success.call(t,e,200,null),t.trigger("sync:success",e)},u=function(e){l.off(o,u),l.off(a,c),delete t.errors,n.error.call(t,e,500,null),t.trigger("sync:error",e)};l.on(a,c,t),l.on(o,u,t),t.trigger("sync:"+e.toLowerCase()),l.send(r,s)},s=function(e){var t=this.get(e);return"1"===t||"true"===t||t===!0||1===t},l=function(e){return!s(e)},c=t.Model.extend({sync:o,getMessenger:i,isTrue:s,isFalse:l});n.include(c.prototype,n.AssociableModel,n.ModelHelpers);var u=t.Collection.extend({sync:o,getMessenger:i,fetchAll:function(e){e=e||{},e.eventName=["read",this.model.prototype.storageEntity,"all"].join(":"),this.fetch(e)}});return n.include(u.prototype,n.CollectionHelpers),r.BaseModel=c,r.BaseCollection=u,{BaseModel:c,BaseCollection:u}}),ABINE_DNTME.define("abine/models/blacklist",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"blacklist",initialize:function(){this.messenger=this.getMessenger()},getDomain:function(){return this.get("domain")},getId:function(){return this.get("id")},fetchByDomain:function(e,t){var n=this,r=e?"create":"read",i=this.get("domain");i&&(i=i.replace(":","::"));var a=r+":blacklist:domain:"+i;this.sync(r,this,{eventName:a,success:function(e){n.set(e),t(null)},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/site]#[loadAccounts]# error event in model.sync eventName: create/read:blacklist:domain:domain"),t("No blacklist")}})},emailEnabled:function(){return this.get("globalEmail")&&!this.get("email")},phoneEnabled:function(){return this.get("globalPhone")&&this.get("premium")&&!this.get("phone")},cardEnabled:function(){return this.get("globalCard")&&this.get("hasEnabledCard")&&!this.get("card")},accountsEnabled:function(){return this.get("hasEnabledAccounts")},passwordsEnabled:function(){return this.get("globalPassword")&&!this.get("password")},loginsEnabled:function(){return this.get("globalLogin")&&!this.get("login")}}),r=t.BaseCollection.extend({model:n});return t.Blacklist=n,t.BlacklistCollection=r,{Blacklist:n,BlacklistCollection:r}}),ABINE_DNTME.define("abine/models/disposableCard",["models","abine/eventLogger"],function(e,t){var n=e.BaseModel.extend({storageEntity:"disposableCard",initialize:function(){},isGift:function(){return this.isTrue("gift")},getCreatedDate:function(){var e=this.get("createdAt").substring(0,10).split("-");return e[1]+"/"+e[2]+"/"+e[0]},isOldMaskedCard:function(){return"old_masked_card"==this.get("cardType")},getBrand:function(){return this.get("brand").toLowerCase()},isCompany:function(){return this.isTrue("company")},getRecipientEmail:function(){return this.get("recipient_email")},getTotalFee:function(){return this.get("total_fee")},isActive:function(){return this.isTrue("active")},getID:function(){return this.id},getGUID:function(){return this.get("guid")},getAmountRefunded:function(){return"$"+(this.get("amount_refunded")/100).toFixed(2)},getOriginalValue:function(){return"$"+(this.get("original_amount")/100).toFixed(2)},getTotalCharge:function(){return"$"+((this.get("original_amount")+this.get("total_fee"))/100).toFixed(2)},isAch:function(){return this.get("payment_source")&&("checking"==this.get("payment_source")||"savings"==this.get("payment_source"))},getCardDetails:function(){return this.getCardNumber()+" - "+this.getExpiry()},getLastFour:function(){return this.get("number").substr(this.get("number").length-4)},getCardNumber:function(){return this.get("number")},getSeparatedCardNumber:function(){var e=this.get("number");return 16==e.length?e.substring(0,4)+" "+e.substring(4,8)+" "+e.substring(8,12)+" "+e.substring(12,16):e},getSeparatedMaskedCardNumber:function(){var e=this.get("number");if(16==e.length)return Array(4).join("**** ")+e.substring(12,16);var t=this.get("type");return t&&t.match(/amex|american/i)?"**** ****** *"+e.substr(-4):Array(e.length-3).join("*")+e.substr(-4)},getMaskedVerification:function(){return Array(this.get("cvc").length+1).join("*")},getMaskedExpiry:function(){return this.getExpiry().replace(/[0-9]/g,"*")},getType:function(){return this.get("type").toLowerCase()},getPrettyNumber:function(){for(var e="",t=0;t<this.get("number").length;t++)e+=this.get("number").charAt(t),t%4==3&&(e+="  ");return e},getCVC:function(){return this.get("cvc")},getExpiry:function(){var e=parseInt(this.get("expiry_month"));return e<10&&(e="0"+e),e+"/"+this.get("expiry_year")},getLabel:function(){var e=this.get("label");return e&&e.length>15&&(e=e.substr(0,12)+"..."),e},getDomain:function(){var e=this.get("domain");return e&&e.length>15&&(e=e.substr(0,12)+"..."),e},getProtectedNumber:function(){var e=this.get("number")+"";return e.substr(0,e.length-12).replace(/./g,"x")+e.substr(e.length-4)},getProtectedVerification:function(){var e=this.get("verification")+"";return e.substr(0,e.length-1).replace(/./g,"x")+e.substr(e.length-1)},toggleDisposable:function(){this.save({active:1===this.get("active")?0:1})}});n.convertStringToCents=function(e){return parseFloat(e).toFixed(2).toString().replace(".","")};var r=e.BaseCollection.extend({model:n,fetchAllLocal:function(e){e=e||{},"undefined"==typeof e.reset&&(e.reset=!0),e.eventName=["read",this.model.prototype.storageEntity,"allLocal"].join(":"),this.fetch(e)},fetchAllBySite:function(e){this.sync("read",this,{eventName:"read:disposableCard:site:"+e,success:function(e){this.reset(e)},error:function(){t.error("[ERROR HANDLER][abine/models/disposableCard][fetchAllBySite]: error event in model.sync event: read:disposableCard:site:id")}})},fetchAllFromServer:function(e){this.sync("read",this,{eventName:"read:disposableCard:server",success:function(t){this.reset(t),e.success(t)},error:function(){e.error(),ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposableCard]#[fetchAllFromServer]# error event in model.sync eventName: read:disposableCard:server")}})},fetchAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:disposableCard:domain:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposableCard]#[fetchAllByDomain]# error event in model.sync eventName: read:disposableCard:domain:domain")}})},comparator:function(e){return new Date-new Date(e.get("createdAt"))}});return e.DisposableCard=n,e.DisposableCardCollection=r,{DisposableCard:n,DisposableCardCollection:r}}),ABINE_DNTME.define("abine/models/disposableEmail",["models","documentcloud/underscore"],function(e,t){var n=e.BaseModel.extend({storageEntity:"disposableEmail",highlighted:!1,initialize:function(){this.hasOne({account:{model:e.Account}})},getId:function(){return this.get("id")},hasWebmail:function(){return!!(this.has("webmails")&&this.get("webmails").length>0)},getWebmailCount:function(){return this.hasWebmail()?this.get("webmails").length:0},hasAccount:function(){return!!(this.has("accountId")&&""!=this.get("accountId")&&this.account&&this.account.accountFields)&&t.any(this.account.accountFields.models,function(e){return e.get("value")==this.getAddress()},this)},getAddress:function(){return this.get("user")+"@"+this.get("domain")},getHighlightedClass:function(){return this.get("highlighted")?"highlighted":""},noConnectionError:function(){return!this.get("err")},isActive:function(){return 1==this.get("active")},toggleDisposable:function(e){this.save({active:1==this.get("active")?0:1},e)},needsTruncation:function(){var e=this.getDomain();return e.length>20},getTruncatedDomain:function(){var e=this.getDomain();return e.substring(0,20)+"..."},getDomain:function(){return this.attributes.label?this.attributes.label:"Unknown"}}),r=e.BaseCollection.extend({model:n,interestedBroadcasts:/broadcast:saveForm:(new|update)/i,initialize:function(){this.messenger=this.getMessenger()},totalWebmails:function(){return t.reduce(this.models,function(e,t){return e+t.getWebmailCount()},0)},countUserCreated:function(){return t.reduce(this.models,function(e,t){return"abine.com"!=t.getDomain()?e+1:e},0)},fetchAllLocal:function(e){e=e||{},"undefined"==typeof e.reset&&(e.reset=!0),e.eventName=["read",this.model.prototype.storageEntity,"allLocal"].join(":"),this.fetch(e)},fetchAllBySite:function(e){this.sync("read",this,{eventName:"read:disposableEmail:site:"+e,success:function(e){this.reset(e)},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposableEmail]#[fetchAllBySite]# error event in model.sync eventName: read:disposableEmail:site:id")}})},fetchAllFromServer:function(e){this.sync("read",this,{eventName:"read:disposableEmail:server",success:function(t){this.reset(t),e()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposableEmail]#[fetchAllFromServer]# error event in model.sync eventName: read:disposableEmail:server")}})},fetchAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:disposableEmail:domain:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposableEmail]#[fetchAllByDomain]# error event in model.sync eventName: read:disposableEmail:domain:domain")}})},comparator:function(e){return new Date-new Date(e.get("createdAt"))}});return e.DisposableEmail=n,e.DisposableEmailCollection=r,{DisposableEmail:n,DisposableEmailCollection:r}}),ABINE_DNTME.define("abine/models/disposablePhone",["models"],function(e){var t=e.BaseModel.extend({storageEntity:"disposablePhone",initialize:function(){this.hasOne({account:{model:e.Account}})},getCountryCode:function(){return this.get("country_code")||"1"},getAreaCode:function(){return this.get("number").substr(0,3)},getExchange:function(){return this.get("number").substr(3,3)},getLocal:function(){return this.get("number").substr(6,4)},getPrettyNumber:function(){return this.isNorthAmericaFormat()?"("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal():this.get("number")},getFullPrettyNumber:function(){return this.isNorthAmericaFormat()?"+"+this.getCountryCode()+" ("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal():"+"+this.getCountryCode()+" "+this.get("number")},getFormattedText:function(){return this.getFullPrettyNumber()},isNorthAmericaFormat:function(){return"1"==this.getCountryCode()},isSuspended:function(){return"true"==this.get("isSuspended")},toggleDisposable:function(){this.save({active:1===this.get("active")?0:1})},toFillData:function(){var e,t=this.toJSON(),n=t.country_code,r=t.number,i="",a="",o="",s="";return"1"==n?(i=r.substring(0,3),o=r.substring(3,6),s=r.substring(6,10),a=o+"-"+s,e="+1 ("+i+") "+o+"-"+s):(a="+"+n+r,e="+"+n+" "+r),t.label=e,t.area=i,t.exchange=o,t.local=s,t.last7=a,t}}),n=e.BaseCollection.extend({model:t,fetchAllBySite:function(e){this.sync("read",this,{eventName:"read:disposablePhone:site:"+e,success:function(e){this.reset(e)},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposablePhone]#[fetchAllBySite]# error event in model.sync event: read:disposablePhone:site:id")}})}});return e.DisposablePhone=t,e.DisposablePhoneCollection=n,{DisposablePhone:t,DisposablePhoneCollection:n}}),ABINE_DNTME.define("abine/models/dntStats",["documentcloud/underscore","models","jquery","abine/intl"],function(e,t,n,r){function i(e){e+="";for(var t=e.split("."),n=t[0],r=t.length>1?"."+t[1]:"",i=/(\d+)(\d{3})/;i.test(n);)n=n.replace(i,"$1,$2");return n+r}var a=t.BaseModel.extend({storageEntity:"dntStats",initialize:function(){this.messenger=this.getMessenger()},addCommas:function(e){e+="";for(var t=e.split("."),n=t[0],r=t.length>1?"."+t[1]:"",i=/(\d+)(\d{3})/;i.test(n);)n=n.replace(i,"$1,$2");return n+r},showMedals:function(){return this.get("showMedals")},viewedBadge:function(){return this.get("viewedBadge")},canAutoShowBadge:function(){if(this.get("viewedBadge")||!this.get("showMedals"))return!1;var e=this.get("earnedOn");return!e||Date.now()-e<2592e5},toggleViewedBadge:function(){this.save({viewedBadge:!this.get("viewedBadge")})},achievedBronze:function(){return this.get("currentBadgeIndex")>-1},achievedSilver:function(){return this.get("currentBadgeIndex")>0},achievedGold:function(){return this.get("currentBadgeIndex")>1},achievedPlatinum:function(){return this.get("currentBadgeIndex")>2},getPlatinumCount:function(){return this.achievedPlatinum()?"x"+(this.get("currentBadgeIndex")-2):"X"},nextMedalAtFormatted:function(){return this.addCommas(this.nextMedalAt())},nextMedalAt:function(){return this.achievedPlatinum()?this.platinumLimit*(this.get("currentBadgeIndex")-1)-this.get("totalAllTimeTrackers"):this.achievedGold()?this.platinumLimit-this.get("totalAllTimeTrackers"):this.achievedSilver()?this.goldLimit-this.get("totalAllTimeTrackers"):this.achievedBronze()?this.silverLimit-this.get("totalAllTimeTrackers"):this.bronzeLimit-this.get("totalAllTimeTrackers")},getFunword:function(){var e=this.get("totalAllTimeTrackers");return e<=100?r.getText("mm_dntme_funword1"):e<=1e3?r.getText("mm_dntme_funword2"):e<=1e4?r.getText("mm_dntme_funword3"):r.getText("mm_dntme_funword4")},getBadgeCount:function(){var e=JSON.parse(this.get("currentBadge"));return this.addCommas(e.limit)},getBadgeType:function(){var e=JSON.parse(this.get("currentBadge"));return e.cssClass},getAllTimeTotalTrackers:function(){return this.get("totalAllTimeTrackers")},formattedTotal:function(){return i(this.get("totalAllTimeTrackers")+"")},totalGreaterThan10000:function(){return this.get("totalAllTimeTrackers")>1e4},totalGreaterThan1000000:function(){return this.get("totalAllTimeTrackers")>1e6},getDailyTotalsByYear:function(e){var t=JSON.parse(this.get("dailyTrackerCounts"));return e in t?t[e]:{}},getBadTrackerDataByYear:function(e){var t=JSON.parse(this.get("badTrackers"));if(!t.totals)return{};var n=t.totals,r={},i=[e,e-1];for(var a in n)for(var o=0;o<i.length;o++){var s=a+"."+i[o];t.daily&&s in t.daily&&(r[a]={},r[a][i[o]]=t.daily[s])}var l={};return{totals:n,daily:r,links:l}}});return t.DntStats=a,{DntStats:a}}),ABINE_DNTME.define("abine/models/preference",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"preference",initialize:function(){},parse:function(e){return"true"==e.value?e.value=!0:"false"==e.value&&(e.value=!1),e},toJSON:function(){var t=e.clone(this.attributes);return t.value===!0?t.value="true":t.value===!1&&(t.value="false"),t}}),r=t.BaseCollection.extend({model:n,interestedBroadcasts:/broadcast:preference:reload/i,parse:function(t){return e(t).map(function(e){return"true"==e.value?e.value=!0:"false"==e.value&&(e.value=!1),e})},restoreDefaults:function(t){this.sync("update",this,{eventName:"update:preference:restore",success:e.bind(function(e){this.reset(this.parse(e)),t()},this),error:function(e){t(e)}})},getPrefFromStorage:function(t,r){this.sync("read",this,{eventName:"read:preference:name:"+t,success:function(t){r(e.isArray(t)&&0===t.length?null:e.isObject(t)?new n(t):null)},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/preference]#[getPrefFromStorage]# error event in model.sync eventName: read:preference:name:key"),r(null)}})},isPrefTrue:function(t){var n=e(this.models).find(function(e){return e.get("key")===t});return!!n&&n.isTrue("value")},getPref:function(t){var n=e(this.models).find(function(e){return e.get("key")===t});return n?n.get("value"):null},isMapper:function(){return!0},setPref:function(n,r){var i=e(this.models).find(function(e){return e.get("key")===n});i?i.save({value:r}):(i=new t.Preference,i.save({key:n,value:r}),this.add(i))},removePref:function(t){var n=e(this.models).find(function(e){return e.get("key")===t});n&&(n.destroy(),this.remove(n))},hasPref:function(t){var n=e(this.models).find(function(e){return e.get("key")===t});return!!n},getSplitTest:function(e){var t=this.getPref("splitTests")||{};try{t=JSON.parse(t)}catch(e){}return t[e]||"default"}});return t.Preference=n,t.PreferenceCollection=r,{Preference:n,PreferenceCollection:r}}),ABINE_DNTME.define("abine/models/loginUrl",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"loginUrl"}),r=t.BaseCollection.extend({model:n,initialize:function(){},fetchAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:loginUrl:site:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/loginUrl]#[fetchAllByDomain]# error event in read:loginUrl:site:domain"),t(!0)}})}});return t.LoginUrl=n,t.LoginUrlCollection=r,{LoginUrl:n,LoginUrlCollection:r}}),ABINE_DNTME.define("abine/models/extensionVersion",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"extensionVersion",initialize:function(){this.messenger=this.getMessenger()}});return t.ExtensionVersion=n,{ExtensionVersion:n}}),ABINE_DNTME.define("abine/models/autofillFeedback",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"autofillFeedback"});return t.AutofillFeedback=n,{AutofillFeedback:n}}),ABINE_DNTME.define("abine/models/mappedForm",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"mappedForm",initialize:function(){this.hasMany({fields:{collection:t.MappedFieldCollection}})},searchSignature:function(t){this.sync("read",this,{eventName:"read:mappedForm:signature:"+this.get("signature"),success:e.bind(function(e){e?(this.set(e),t()):t(!0)},this),error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/mappedForm]#[searchSignature]# error event in searchSignature"),t(!0)}})}}),r=t.BaseCollection.extend({model:n,initialize:function(e){this.messenger=e.messenger},fetchAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:mappedForm:site:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/mappedForm]#[fetchAllByDomain]# error event in read:mappedForm:site:domain"),t(!0)}})},fetchLocalAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:mappedForm:local:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/mappedForm]#[fetchAllByDomain]# error event in read:mappedForm:site:domain"),t(!0)}})}});return t.MappedForm=n,t.MappedFormCollection=r,{MappedForm:n,MappedFormCollection:r}}),ABINE_DNTME.define("abine/models/mappedField",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"mappedField",initialize:function(){}}),r=t.BaseCollection.extend({model:n,initialize:function(){}});return t.MappedField=n,t.MappedFieldCollection=r,{MappedField:n,MappedFieldCollection:r}}),ABINE_DNTME.define("abine/models/mappingMenu",["documentcloud/underscore","models"],function(e,t){function n(e){if(e.children)for(var t=0;t<e.children.length;t++)n(e.children[t]);else if(e.type){if(m[e.type])return;var r;if(r=e.label?e.label:e.name,r=r.replace(/\([^\)]+\)/g,"").replace(/^[\s]+|[\s]+$/g,""),r.indexOf("{")!=-1)return;m[e.type]=r}}function r(e){if(null==m){m={};for(var t in p)p[t].length>=0||n(p[t])}return m[e]||"Unknown"}function i(e){if(null==e)return"Other";var t={loginForm:"Login",registrationForm:"Register",checkoutForm:"Checkout",addressForm:"Address",changePasswordForm:"Change Password"};return e in t?t[e]:"Other"}function a(e,t,n,r,i){var a=[];if(!i)return a;var o={};for(var s in t)o[s]=t[s];for(var l=0,s=0;s<i.length;s++){var d=i.at(s),h=d.toFillData(),f={};u(t,n,h,f),f.label.indexOf("{")==-1&&(c(t,n,f),f.path=e+"."+r+"."+l,f.hasChildren=!0,a.push(new _(f)),l++)}return a}function o(e,t,n,r,i,a){var o={},s=i.toFillData();return u(t,n,s,o),o.label.indexOf("{")!=-1?null:(o.path=e+"."+r+"."+a,n.children&&(o.hasChildren=!0),c(t,n,o),l(n,o),null!=o.value&&(o.value=f(s,o.value),o.value.indexOf("{")!=-1)?null:new _(o))}function s(e,t,n,r,i){var a={};return a.label=f(n,r.name),a.label.indexOf("{")!=-1&&r.alternate_name&&(a.label=f(n,r.alternate_name)),a.label.indexOf("{")!=-1?null:(a.path=e+"."+i,c(n,r,a),r.children?a.hasChildren=!0:(l(r,a),t&&a.label.indexOf("never show auto-fill here")!=-1&&(a.label="Auto-fill disabled here, please enable.<br/>(show auto-fill here)",a.action="show_here")),new _(a))}function l(e,t){e.action&&(t.action=e.action),e.type&&(t.type=e.type),e.formType&&(t.formType=e.formType),e.value&&(t.value=e.value)}function c(e,t,n){t.panel_title&&(n.panelTitle=f(e,t.panel_title),n.panelTitle.indexOf("{")!=-1&&(n.panelTitle=n.panelTitle.replace(/\{[^\}]+\}/g,"Unknown")))}function u(e,t,n,r){r.label=f(e,t.name),r.label=f(n,r.label),r.label.indexOf("{")!=-1&&t.alternate_name&&(r.label=f(e,t.alternate_name),r.label=f(n,r.label))}function d(e,t){if(e.match(y))return"Address";if(e.match(g))return"Name";if(e.match(v))return"Card";if(e.match(b))return"Phone";if(e.match(w)){if("loginForm"==t)return"Login";if("registrationForm"==t)return"Register"}return null}function h(e,t){if(t.ref){var n=null;t.name&&(n=t.name),t=e[t.ref],null!=n&&(t.name=n)}return t}function f(e,t){for(var n in e)if(e[n]){if(n.indexOf("{")==-1)var r="{"+n+"}";else var r=n;var r=r.replace(/[\{\}]/g,"\\$&");t=t.replace(new RegExp(r,"g"),e[n])}return t}var p={loginForm:["dont_show","fill_logins","correct_login","mapping","list_accounts","list_emails","list_phones","report"],registrationForm:["dont_show","register","login_on_register","mapping","list_emails","list_phones","report"],checkoutForm:["dont_show","wallet","mapping","list_cards","list_emails","list_phones","report"],identityForm:["dont_show","identity","mapping","list_identities","list_emails","list_phones","list_phones","report"],addressForm:["dont_show","address","mapping","list_addresses","list_emails","list_phones","report"],phoneForm:["dont_show","phone","mapping","list_phones","report"],otherForm:["dont_show","mapping","report"],mapping:{id:"mapping",name:"Fill something different than {data_type}",alternate_name:"Fill unknown field with",children:[{ref:"register",name:"Fill Email, Username, or Password"},{ref:"wallet",name:"Fill Credit Cards or Masked Cards"},{ref:"address",name:"Fill Addresses"},{ref:"phone",name:"Fill Phones"},{ref:"others"}]},more:{id:"more",name:"More",action:"show_more"},report:{id:"report",name:"Report a problem (improve Blur) >",action:"report_problem"},dont_show_extension:{id:"dont_show",name:"Don't show again here",panel_title:"Blur sees: <u>{data_type}</u> on <u class=formType>{form_type}</u> Page",action:"dont_show_here"},dont_show:{id:"dont_show",name:"Don't show again here?",panel_title:"Blur sees: <u>{data_type}</u> on <u class=formType>{form_type}</u> Page",children:[{id:"field",name:"Don't show again on this field",action:"dont_show_on_field"},{id:"form",name:"Don't show again on this form",action:"dont_show_on_form"},{id:"site",name:"Don't show again on this {app}",action:"dont_show_on_site"}]},fill_logins:{id:"accounts",name:"Fill existing account info",when:"account_has_data",children:[{id:"{account}",name:"{label}",panel_title:"Select existing account info to fill",entities:"account",children:[{id:"{email}",name:"{email}",label:"Email",entity:"account",action:"fill",type:"/contact/email",formType:"loginForm"},{id:"{username}",name:"{username}",label:"Username",entity:"account",action:"fill",type:"/nameperson/friendly",formType:"loginForm"},{id:"{password}",name:"Password for {label}",label:"Password",entity:"account",value:"{password}",action:"fill",type:"/password",formType:"loginForm"}]}]},correct_login:{id:"correct",name:"Correct how the <b>{data_type}</b> is filled",children:[{id:"email",name:"Email",type:"/contact/email",formType:"loginForm"},{id:"username",name:"Username",type:"/nameperson/friendly",formType:"loginForm"},{id:"password",name:"Password",type:"/password",formType:"loginForm"},{id:"otp",name:"One Time Password",type:"/auth/otp"}]},list_accounts:{id:"list_accounts",name:"Add/Edit My Accounts",action:"show_list_accounts"},list_emails:{id:"list_emails",name:"Add/Edit My Emails",forType:"email",action:"show_list_identities"},list_phones:{id:"list_phones",name:"Add/Edit My Phones",forType:"phone",action:"show_list_identities"},list_cards:{id:"list_cards",name:"Add/Edit My Cards",action:"show_list_cards"},list_addresses:{id:"list_addresses",name:"Add/Edit My Addresses",action:"show_list_addresses"},list_identities:{id:"list_identities",name:"Add/Edit My Identities",action:"show_list_identities"},register:{id:"register",name:"Correct how the <b>{data_type}</b> is filled",panel_title:"Blur sees: <u>{data_type}</u> on <u class=formType>{form_type}</u> Page",children:[{id:"mask_email",name:"Fill New Masked Email",label:"Email",panel_title:"Blur sees: <u>{data_type}</u> on <u class=formType>{form_type}</u> Page",action:"mask_email",type:"/contact/email"},{id:"real_email",name:"Fill My Email ({email})",action:"real_email"},{id:"password1",name:"Fill New Strong Password",type:"/password/differentSpecialChars",action:"strong_password"},{id:"security",name:"Fill New Custom Password",label:"Password",children:[{id:"password2",name:"Limited special chars (.-_)",label:"Password with limited special chars",type:"/password/differentSpecialChars",action:"strong_password"},{id:"password3",name:"No special characters",label:"Password without special",type:"/password/noSpecialChars",action:"strong_password"},{id:"password4",name:"No numbers",label:"Password without numbers",type:"/password/noNumbers",action:"strong_password"}]},{id:"username",name:"Fill Username",label:"Username",type:"/nameperson/friendly"}]},login_on_register:{id:"login",name:"Login fields on register form",children:[{id:"loginemail",name:"Login Username or Email",panel_title:"Fill <u>email/password</u> Login info on this combined form",type:"/contact/email/login"},{id:"loginpassword",name:"Login Password",type:"/password/login"}]},wallet:{id:"cards",name:"Correct how the <b>{data_type}</b> is filled",when:"card_has_data",children:[{id:"mask",name:"Fill Masked Card",panel_title:"Blur sees: <u>{data_type}</u> on <u class=formType>{form_type}</u> Page",action:"mask_card"},{id:"{card}",name:"Fill {label} (x{last_4})",page_title:"Select existing card info to fill",entities:"card",children:[{id:"number",name:"Fill Card # - <small>x{last_4}</small>",page_title:"Fill {label} (x{last_4})",entity:"card",children:[{id:"number",name:"Fill Card # - <small>x{last_4}</small>",label:"Card Number",page_title:"Fill Full Card #",entity:"card",value:"{number}",action:"fill",type:"/financial/creditcard/number"},{id:"part1",name:"Fill Card # - first 4",label:"Card Number Part 1",entity:"card",value:"{first_4}",action:"fill",type:"/financial/creditcard/part1"},{id:"part2",name:"Fill Card # - second 4",label:"Card Number Part 2",entity:"card",value:"{second_4}",action:"fill",type:"/financial/creditcard/part2"},{id:"part3",name:"Fill Card # - third 4",label:"Card Number Part 3",entity:"card",value:"{third_4}",action:"fill",type:"/financial/creditcard/part3"},{id:"part4",name:"Fill Card # - last 4",label:"Card Number Part 4",entity:"card",value:"{last_4}",action:"fill",type:"/financial/creditcard/part4"},{id:"amex1",name:"Fill Card # - first 4",label:"Amex Number Part 1",entity:"card",value:"{amex_4}",type:"/financial/creditcard/amex/part1"},{id:"amex2",name:"Fill Card # - second 6",label:"Amex Number Part 2",entity:"card",value:"{amex_6}",type:"/financial/creditcard/amex/part2"},{id:"amex3",name:"Fill Card # - last 4",label:"Amex Number Part 3",entity:"card",value:"{amex_5}",type:"/financial/creditcard/amex/part3"}]},{id:"holder_name",name:"Card holder name - <small>{full_name}</small>",entity:"card",children:[{id:"issued",name:"Full Name - <small>{full_name}</small>",label:"Card Holder Name",value:"{full_name}",page_title:"Fill {label} (x{last_4})",entity:"card",action:"fill",type:"/financial/creditcard/issuedto"},{id:"first",name:"First Name - <small>{first_name}</small>",label:"Card Holder First Name",value:"{first_name}",entity:"card",action:"fill",type:"/financial/creditcard/issuedto/first"},{id:"last",name:"Last Name - <small>{last_name}</small>",label:"Card Holder Last Name",value:"{last_name}",entity:"card",action:"fill",type:"/financial/creditcard/issuedto/last"}]},{id:"cvv",name:"Fill CVV/CVC/CVV2",label:"CVV/CVC/CVV2",value:"{cvc}",entity:"card",action:"fill",type:"/financial/creditcard/verification"},{id:"expiry",name:"Fill Expiry Date - <small>{expiry}</small>",label:"Card Expiry (mm/yyyy)",value:"{expiry}",entity:"card",action:"fill",type:"/financial/creditcard/expiry"},{id:"expiry2",name:"Fill Expiry Date - <small>{expiry2}</small>",label:"Card Expiry (mm/yy)",value:"{expiry2}",entity:"card",action:"fill",type:"/financial/creditcard/expiry2"},{id:"month",name:"Fill Expiry month - <small>{expiry_month}</small>",label:"Card Expiry Month",value:"{expiry_month}",entity:"card",action:"fill",type:"/financial/creditcard/expirymonth"},{id:"year",name:"Fill Expiry year - <small>{expiry_year}</small>",label:"Card Expiry Year (yyyy)",value:"{expiry_year}",entity:"card",action:"fill",type:"/financial/creditcard/expiryyear"},{id:"year2",name:"Fill Expiry year - <small>{expiry_year2}</small>",label:"Card Expiry Year (yy)",value:"{expiry_year2}",entity:"card",action:"fill",type:"/financial/creditcard/expiryyear2"},{id:"type",name:"Fill Card type - <small>{type}</small>",label:"Card Type",value:"{type}",entity:"card",action:"fill",type:"/financial/creditcard/type"},{id:"address",name:"Fill Card Billing Address - <small>{address1}</small>",entity:"card",children:[{id:"address1",name:"Fill Address Line 1 - <small>{address1}</small> ",label:"Address Line 1",value:"{address1}",entity:"card",action:"fill",type:"/contact/postaladdress/billing"},{id:"address2",name:"Fill Address Line 2 - <small>{address2}</small>",label:"Address Line 2",value:"{address2}",entity:"card",action:"fill",type:"/contact/postaladdressAdditional/billing"},{id:"address3",name:"Fill Address Line 3 - <small>{address3}</small>",label:"Address Line 3",value:"{address3}",entity:"card",action:"fill",type:"/contact/postaladdress3/billing"},{id:"city",name:"Fill City - <small>{city}</small>",label:"City",value:"{city}",entity:"card",action:"fill",type:"/contact/city/billing"},{id:"state",name:"Fill State - <small>{state}</small>",label:"State",value:"{state}",action:"fill",entity:"card",type:"/contact/state/billing"},{id:"statecode",name:"Fill State Code - <small>{state}</small>",label:"State Code",value:"{state}",entity:"card",action:"fill",type:"/contact/state/code/billing"},{id:"country",name:"Fill Country - <small>{country}</small>",label:"Country",value:"{country}",entity:"card",action:"fill",type:"/contact/country/billing"},{id:"zip",name:"Fill Zip/Postal Code - <small>{zip}</small>",label:"Zip/Postal Code",entity:"card",value:"{zip}",action:"fill",type:"/contact/postalcode/billing"},{id:"zip+",name:"Fill Zip+4 - <small>{zip4}</small>",label:"Zip+4",entity:"card",value:"{zip4}",action:"fill",type:"/contact/zip4/billing"}]}]},{ref:"list_cards"}]},identity:{id:"identity",name:"Correct how the <b>{data_type}</b> is filled",when:"identity_has_data",children:[{id:"{identity}",name:"Fill {label} - <small>{full_name}</small>",page_title:"Select existing identity info to fill",entities:"identity",children:[{id:"full",name:"Full Name - <small>{full_name}</small>",label:"Full Name",value:"{full_name}",entity:"identity",action:"fill",type:"/nameperson/full"},{id:"first",name:"Fill First name - <small>{first_name}</small>",label:"First Name",value:"{first_name}",entity:"identity",action:"fill",type:"/nameperson/first"},{id:"middle",name:"Fill Middle name - <small>{middle_name}</small>",label:"Middle Name",value:"{middle_name}",entity:"identity",action:"fill",type:"/nameperson/middle"},{id:"last",name:"Fill Last name - <small>{last_name}</small>",label:"Last Name",value:"{last_name}",entity:"identity",action:"fill",type:"/nameperson/last"},{id:"email",name:"Fill Email - <small>{real_email}</small>",value:"{real_email}",entity:"identity",action:"fill",type:"/contact/email"},{id:"username",name:"Fill Username - <small>{username}</small>",label:"Username",value:"{username}",entity:"identity",action:"fill",
type:"/nameperson/friendly"},{id:"dob",name:"Date of birth - <small>{dob_month}/{dob_day}/{dob_year}</small>",entity:"identity",children:[{id:"month",name:"Birth month - <small>{dob_month}</small>",label:"Birth month",value:"{dob_month}",entity:"identity",action:"fill",type:"/birthdate/birthmonth"},{id:"day",name:"Birth day - <small>{dob_day}</small>",label:"Birth day",value:"{dob_day}",entity:"identity",action:"fill",type:"/birthdate/birthday"},{id:"year",name:"Birth year - <small>{dob_year}</small>",label:"Birth year",value:"{dob_year}",entity:"identity",action:"fill",type:"/birthdate/birthyear"},{id:"mmddyyyy1",name:"Birth Date - <small>{dob_month}-{dob_day}-{dob_year}</small>",label:"Birth Date",value:"{dob_month}-{dob_day}-{dob_year}",entity:"identity",action:"fill",type:"/birthdate/MM-DD-YYYY"},{id:"mmddyyyy2",name:"Birth Date - <small>{dob_month}/{dob_day}/{dob_year}</small>",label:"Birth Date",value:"{dob_month}/{dob_day}/{dob_year}",entity:"identity",action:"fill",type:"/birthdate/MM/DD/YYYY"},{id:"ddmmyyyy1",name:"Birth Date - <small>{dob_day}-{dob_month}-{dob_year}</small>",label:"Birth Date",value:"{dob_day}-{dob_month}-{dob_year}",entity:"identity",action:"fill",type:"/birthdate/DD-MM-YYYY"},{id:"ddmmyyyy2",name:"Birth Date - <small>{dob_day}/{dob_month}/{dob_year}</small>",label:"Birth Date",value:"{dob_day}/{dob_month}/{dob_year}",entity:"identity",action:"fill",type:"/birthdate/DD/MM/YYYY"}]},{id:"company",name:"Fill Company - <small>{company}</small>",value:"{company}",entity:"identity",action:"fill",type:"/company/name"},{id:"position",name:"Company Position",value:"{designation}",entity:"identity",action:"fill",type:"/company/position"},{id:"website",name:"Website Url",value:"{url}",entity:"identity",action:"fill",type:"/website"},{id:"ssn",name:"SSN #",value:"{ssn}",entity:"identity",action:"fill",type:"/socialSecurityNumber"},{id:"dl",name:"Driver License",value:"{driver_license}",entity:"identity",action:"fill",type:"/driverLicense"}]},{ref:"list_identities"}]},address:{id:"address",name:"Correct how the <b>{data_type}</b> is filled",children:[{id:"{address}",name:"Fill {label} - <small>{address1}</small>",page_title:"Select existing address info to fill",entities:"address",children:[{id:"address1",name:"Fill Address Line 1 - <small>{address1}</small> ",page_title:"Fill Address - <small>{address1}</small>",value:"{address1}",entity:"address",action:"fill",type:"/contact/postaladdress"},{id:"address2",name:"Fill Address Line 2 - <small>{address2}</small>",value:"{address2}",entity:"address",action:"fill",type:"/contact/postaladdressAdditional"},{id:"address3",name:"Fill Address Line 3 - <small>{address3}</small>",value:"{address3}",entity:"address",action:"fill",type:"/contact/postaladdress3"},{id:"city",name:"Fill City - <small>{city}</small>",value:"{city}",entity:"address",action:"fill",type:"/contact/city"},{id:"state",name:"Fill State - <small>{state}</small>",value:"{state}",action:"fill",entity:"address",type:"/contact/state"},{id:"statecode",name:"Fill State Code - <small>{state}</small>",value:"{state}",entity:"address",action:"fill",type:"/contact/state/code"},{id:"country",name:"Fill Country - <small>{country}</small>",value:"{country}",entity:"address",action:"fill",type:"/contact/country"},{id:"zip",name:"Fill Zip/Postal Code - <small>{zip}</small>",label:"Zip/Postal Code",entity:"address",value:"{zip}",action:"fill",type:"/contact/postalcode"},{id:"zip+",name:"Fill Zip+4 - <small>{zip4}</small>",label:"Zip+4",entity:"address",value:"{zip4}",action:"fill",type:"/contact/zip4"}]},{id:"mask_address",name:"Fill Masked Card Address - <small>280 Summer St</small>",children:[{id:"address1",name:"Fill Address Line 1 - <small>280 Summer St</small> ",label:"Address Line 1",page_title:"Fill Masked Card Address - <small>280 Summer St, 02210</small>",value:"280 Summer St",action:"fill",type:"/contact/postaladdress"},{id:"city",name:"Fill City - <small>Boston</small>",label:"City",value:"Boston",action:"fill",type:"/contact/city"},{id:"state",name:"Fill State - <small>MA</small>",label:"State",value:"MA",action:"fill",type:"/contact/state"},{id:"country",name:"Fill Country - <small>US</small>",label:"Country",value:"US",action:"fill",type:"/contact/country"},{id:"zip",name:"Fill Zip/Postal Code - <small>02210</small>",label:"Zip/Postal Code",value:"02210",action:"fill",type:"/contact/postalcode"}]},{ref:"list_addresses"}]},phone:{id:"phone",name:"Correct how the <b>{data_type}</b> is filled",children:[{id:"{phone}",name:"{label}",page_title:"Select existing phone info to fill",entities:"phone",children:[{id:"full",name:"Phone - <small>{number}</small>",label:"Phone Number (xxx-yyy-zzzz)",entity:"phone",value:"{number}",action:"fill",type:"/contact/phone"},{id:"area",name:"Phone areacode - <small>{area}</small>",label:"Phone Areacode (xxx)",entity:"phone",value:"{area}",action:"fill",type:"/contact/phone/areacode"},{id:"exchange",name:"Phone exchange - <small>{exchange}</small>",label:"Phone Exchange (yyy)",entity:"phone",value:"{exchange}",action:"fill",type:"/contact/phone/exchange"},{id:"local",name:"Phone local - <small>{local}</small>",label:"Phone Local (zzzz)",entity:"phone",value:"{local}",action:"fill",type:"/contact/phone/local"},{id:"number",name:"Phone last 7 - <small>{last7}</small>",label:"Phone Last 7 (yyy-zzzz)",entity:"phone",value:"{last7}",action:"fill",type:"/contact/phone/number"},{id:"country",name:"Phone country code - <small>{country_code}</small>",label:"Phone Country Code",entity:"phone",value:"{country_code}",action:"fill",type:"/contact/phone/countrycode"},{id:"ext",name:"Phone extension",label:"Phone Extension",entity:"phone",value:"{ext}",action:"fill",type:"/contact/phone/extension"}]},{id:"list",name:"Add/Edit My Phones",action:"show_list_identities"}]},others:{id:"others",name:"Others",children:[{id:"name_types",name:"Name",children:[{id:"full",name:"Full Name",type:"/nameperson/full"},{id:"first",name:"First Name",type:"/nameperson/first"},{id:"last",name:"Last Name",type:"/nameperson/last"},{id:"middle",name:"Middle Name",type:"/nameperson/middle"},{id:"prefix",name:"Title (Mr/Mrs/Ms)",type:"/nameperson/prefix"},{id:"suffix",name:"Suffix (Jr/Sr/II)",type:"/nameperson/suffix"}]},{id:"dob",name:"Date of birth",children:[{id:"age",name:"Age",type:"/birthdate/age"},{id:"month",name:"Birth month",type:"/birthdate/birthmonth"},{id:"day",name:"Birth day",type:"/birthdate/birthday"},{id:"year",name:"Birth year",type:"/birthdate/birthyear"},{id:"mmddyyyy1",name:"Birth Date (MM-DD-YYYY)",type:"/birthdate/MM-DD-YYYY"},{id:"mmddyyyy2",name:"Birth Date (MM/DD/YYYY)",type:"/birthdate/MM/DD/YYYY"},{id:"ddmmyyyy1",name:"Birth Date (DD-MM-YYYY)",type:"/birthdate/DD-MM-YYYY"},{id:"ddmmyyyy2",name:"Birth Date (DD/MM/YYYY)",type:"/birthdate/DD/MM/YYYY"}]},{id:"gender",name:"Gender",type:"/person/gender"},{id:"website",name:"Website Url",type:"/website"},{id:"company",name:"Company Name",type:"/company/name"},{id:"position",name:"Company Position",type:"/company/position"},{id:"ssn",name:"SSN #",type:"/socialSecurityNumber"},{id:"dl",name:"Driver License",type:"/driverLicense"},{id:"ff",name:"Frequent Flier #",type:"/loyalty/flier"},{id:"lc",name:"Loyalty Card #",type:"/loyalty/card"},{id:"captcha",name:"Captcha",type:"/captcha"},{id:"otp",name:"One Time Password",type:"/auth/otp"},{id:"hint",name:"Password Hint",type:"/auth/hint"},{id:"question",name:"Security Question",type:"/auth/question"},{id:"answer",name:"Security Answer",type:"/auth/answer"},{id:"comment",name:"Comment",type:"/comment"},{id:"subject",name:"Subject",type:"/subject"},{id:"message",name:"Message",type:"/message"}]},change:{id:"change",name:"Fill Change Password Form",forForm:"changePassword",children:[{id:"email",name:"Email",type:"/contact/email"},{id:"password1",name:"Old Password",type:"/passwordold"},{id:"password2",name:"New Password",children:[{id:"password1",name:"Password",type:"/password"},{id:"password2",name:"Limited special chars (.-_)",label:"Password with .-_",type:"/password/differentSpecialChars"},{id:"password3",name:"No special characters",label:"Password without special",type:"/password/noSpecialChars"},{id:"password4",name:"No numbers",label:"Password without numbers",type:"/password/noNumbers"}]}]},address_mapping:{id:"correct",name:"Correct an Address Auto-fill Problem",children:[{id:"default",name:"Default Address",children:[{id:"address1",name:"Address Line 1",type:"/contact/postaladdress"},{id:"address2",name:"Address Line 2",type:"/contact/postaladdressAdditional"},{id:"address3",name:"Address Line 3",type:"/contact/postaladdress3"},{id:"city",name:"City",type:"/contact/city"},{id:"state",name:"State",type:"/contact/state"},{id:"statecode",name:"State Code",type:"/contact/state/code"},{id:"country",name:"Country",type:"/contact/country"},{id:"zip",name:"Zip/Postal Code",type:"/contact/postalcode"},{id:"zip+",name:"Zip+4",type:"/contact/zip4"}]},{id:"billing",name:"Billing Address",children:[{id:"address1",name:"Address Line 1",type:"/contact/postaladdress/billing"},{id:"address2",name:"Address Line 2",type:"/contact/postaladdressAdditional/billing"},{id:"address3",name:"Address Line 3",type:"/contact/postaladdress3/billing"},{id:"city",name:"City",type:"/contact/city/billing"},{id:"state",name:"State",type:"/contact/state/billing"},{id:"statecode",name:"State Code",type:"/contact/state/code/billing"},{id:"country",name:"Country",type:"/contact/country/billing"},{id:"zip",name:"Zip/Postal Code",type:"/contact/postalcode/billing"},{id:"zip+",name:"Zip+4",type:"/contact/zip4/billing"}]},{id:"shipping",name:"Shipping Address",children:[{id:"address1",name:"Address Line 1",type:"/contact/postaladdress/shipping"},{id:"address2",name:"Address Line 2",type:"/contact/postaladdressAdditional/shipping"},{id:"address3",name:"Address Line 3",type:"/contact/postaladdress3/shipping"},{id:"city",name:"City",type:"/contact/city/shipping"},{id:"state",name:"State",type:"/contact/state/shipping"},{id:"statecode",name:"State Code",type:"/contact/state/code/shipping"},{id:"country",name:"Country",type:"/contact/country/shipping"},{id:"zip",name:"Zip/Postal Code",type:"/contact/postalcode/shipping"},{id:"zip+",name:"Zip+4",type:"/contact/zip4/shipping"}]},{id:"business",name:"Business Address",children:[{id:"address1",name:"Address Line 1",type:"/contact/postaladdress/business"},{id:"address2",name:"Address Line 2",type:"/contact/postaladdressAdditional/business"},{id:"address3",name:"Address Line 3",type:"/contact/postaladdress3/business"},{id:"city",name:"City",type:"/contact/city/business"},{id:"state",name:"State",type:"/contact/state/business"},{id:"statecode",name:"State Code",type:"/contact/state/code/business"},{id:"country",name:"Country",type:"/contact/country/business"},{id:"zip",name:"Zip/Postal Code",type:"/contact/postalcode/business"},{id:"zip+",name:"Zip+4",type:"/contact/zip4/business"}]},{id:"home",name:"Home Address",children:[{id:"address1",name:"Address Line 1",type:"/contact/postaladdress/home"},{id:"address2",name:"Address Line 2",type:"/contact/postaladdressAdditional/home"},{id:"address3",name:"Address Line 3",type:"/contact/postaladdress3/home"},{id:"city",name:"City",type:"/contact/city/home"},{id:"state",name:"State",type:"/contact/state/home"},{id:"statecode",name:"State Code",type:"/contact/state/code/home"},{id:"country",name:"Country",type:"/contact/country/home"},{id:"zip",name:"Zip/Postal Code",type:"/contact/postalcode/home"},{id:"zip+",name:"Zip+4",type:"/contact/zip4/home"}]}]},phone_mapping:{id:"correct",name:"Correct an Phone Auto-fill Problem",children:[{id:"default",name:"Default Phone",children:[{id:"full",name:"Phone (xxx-yyy-zzzz)",type:"/contact/phone"},{id:"area",name:"Phone areacode (xxx)",type:"/contact/phone/areacode"},{id:"exchange",name:"Phone exchange (yyy)",type:"/contact/phone/exchange"},{id:"local",name:"Phone local (zzzz)",type:"/contact/phone/local"},{id:"number",name:"Phone last 7 (yyy-zzzz)",type:"/contact/phone/number"},{id:"country",name:"Phone country code",type:"/contact/phone/countrycode"},{id:"ext",name:"Phone extension",type:"/contact/phone/extension"}]},{id:"home",name:"Home Phone",children:[{id:"full",name:"Phone (xxx-yyy-zzzz)",type:"/contact/phone/home"},{id:"area",name:"Phone areacode (xxx)",type:"/contact/phone/areacode/home"},{id:"exchange",name:"Phone exchange (yyy)",type:"/contact/phone/exchange/home"},{id:"local",name:"Phone local (zzzz)",type:"/contact/phone/local/home"},{id:"number",name:"Phone last 7 (yyy-zzzz)",type:"/contact/phone/number/home"},{id:"country",name:"Phone country code",type:"/contact/phone/countrycode/home"},{id:"ext",name:"Phone extension",type:"/contact/phone/extension/home"}]},{id:"work",name:"Work Phone",children:[{id:"full",name:"Phone (xxx-yyy-zzzz)",type:"/contact/phone/work"},{id:"area",name:"Phone areacode (xxx)",type:"/contact/phone/areacode/work"},{id:"exchange",name:"Phone exchange (yyy)",type:"/contact/phone/exchange/work"},{id:"local",name:"Phone local (zzzz)",type:"/contact/phone/local/work"},{id:"number",name:"Phone last 7 (yyy-zzzz)",type:"/contact/phone/number/work"},{id:"country",name:"Phone country code",type:"/contact/phone/countrycode/work"},{id:"ext",name:"Phone extension",type:"/contact/phone/extension/work"}]},{id:"mobile",name:"Mobile Phone",children:[{id:"full",name:"Phone (xxx-yyy-zzzz)",type:"/contact/phone/mobile"},{id:"area",name:"Phone areacode (xxx)",type:"/contact/phone/areacode/mobile"},{id:"exchange",name:"Phone exchange (yyy)",type:"/contact/phone/exchange/mobile"},{id:"local",name:"Phone local (zzzz)",type:"/contact/phone/local/mobile"},{id:"number",name:"Phone last 7 (yyy-zzzz)",type:"/contact/phone/number/mobile"},{id:"country",name:"Phone country code",type:"/contact/phone/countrycode/mobile"},{id:"ext",name:"Phone extension",type:"/contact/phone/extension/mobile"}]},{id:"fax",name:"Fax Phone",children:[{id:"full",name:"Phone (xxx-yyy-zzzz)",type:"/contact/phone/fax"},{id:"area",name:"Phone areacode (xxx)",type:"/contact/phone/areacode/fax"},{id:"exchange",name:"Phone exchange (yyy)",type:"/contact/phone/exchange/fax"},{id:"local",name:"Phone local (zzzz)",type:"/contact/phone/local/fax"},{id:"number",name:"Phone last 7 (yyy-zzzz)",type:"/contact/phone/number/fax"},{id:"country",name:"Phone country code",type:"/contact/phone/countrycode/fax"},{id:"ext",name:"Phone extension",type:"/contact/phone/extension/fax"}]}]}},m=null,y=/postal|city|state|contact\/country/i,g=/(nameperson\/(first|last|middle|full))|social|company|dob|driver|website/i,v=/financial/i,b=/phone/i,w=/\/email|\/friendly|\/password/i,_=t.BaseModel.extend({initialize:function(){}}),E=t.BaseCollection.extend({model:_,initialize:function(){},loadMenu:function(e,t,n,l,c){var u={},f=-1;if(e.match(/.*\.[0-9]+$/)){var m=e.lastIndexOf(".");f=parseInt(e.substr(m+1)),e=e.substring(0,m)}if(null!=t&&(u["{data_type}"]=r(t)),null!=n&&(u["{form_type}"]=i(n)),null!=t&&null!=n){var w=d(t,n);null!=w&&(u["{group}"]=w)}u["{app}"]="site",c.email&&(u["{email}"]=c.email);var _=e.indexOf(".more")!=-1,E=[],A=e.replace(".more","").split(/\./),T=p,k={},S={children:[]};k.root=S,null!=t&&(t.match(y)?n="addressForm":t.match(b)?n="phoneForm":t.match(v)?n="checkoutForm":t.match(g)&&(n="identityForm")),T[n]||(n="otherForm");for(var C=T[n],I=0;I<C.length;I++){var N=C[I];if("more"!=N||!_){"dont_show"==N&&(N="dont_show_extension");var D=T[N];if((!D.forType||null!=t&&t.match(new RegExp(D.forType,"i")))&&(S.children.push(D),!_&&"more"==N))break}}for(var I=0;I<A.length;I++){var x=A[I];if(k[x])k=k[x];else if(k.children)for(var M=k.children,P=0;P<M.length;P++){var R=M[P];R=h(T,R),R.id==x&&(k=R)}}if(k.children)for(var M=k.children,I=0;I<M.length;I++){var R=M[I];R=h(T,R);var B=R.id;if(R.when){var O=R.when;if(O.indexOf("has_data")!=-1&&0==c[O.replace("_has_data","")].length)continue}if("mask_card"!=R.action)if(R.entities){var F=a(e,u,R,B,c[R.entities]);E=E.concat(F),c.CurrentEntity=null}else if(R.entity){var L,q=c[R.entity];f==-1?L=c.CurrentEntity:(L=q.at(f),c.CurrentEntity=L);var U=o(e,u,R,B,L,f);null!=U&&E.push(U)}else{var U=s(e,l,u,R,B);null!=U&&E.push(U)}}for(var I=0;I<E.length;I++)E[I].set("idx",I);this.reset(E)}});return t.MappingMenu=_,t.MappingMenuCollection=E,{MappingMenu:_,MappingMenuCollection:E}}),ABINE_DNTME.define("abine/models/shieldedCard",["models","documentcloud/underscore","abine/eventLogger"],function(e){var t=e.BaseModel.extend({storageEntity:"shieldedCard",interestedBroadcasts:/broadcast:billinginfo:updated/i,generateDisposable:function(){return new e.DisposableCard({shielded_card_id:this.get("id")})},getName:function(){return this.get("first_name")+" "+this.get("last_name")},getExpiry:function(){return parseInt(this.get("month"))+" / "+parseInt(this.get("year"))},getFirstName:function(){return this.get("first_name").toUpperCase()},getLastName:function(){return this.get("last_name").toUpperCase()},getLastFour:function(){return this.get("last_four")},getProtectedNumber:function(){if(!this.get("number"))return"---";var e=this.get("number")+"";return e.substr(0,e.length-4).replace(/./g,"x")+e.substr(e.length-4)},getProtectedVerification:function(){if(!this.get("number"))return"---";var e=this.get("verification")+"";return e.substr(0,e.length-1).replace(/./g,"x")+e.substr(e.length-1)}}),n=e.BaseCollection.extend({model:t,getPrimaryCardName:function(){return this.models.length>0?this.models[0].getFirstName+" "+this.models[0].getLastName():""},getPrimaryCardLastFour:function(){return this.models.length>0?this.models[0].getLastFour():""},getPrimaryCardExpiry:function(){return this.models.length>0?this.models[0].get:""}});return e.ShieldedCard=t,e.ShieldedCardCollection=n,{ShieldedCard:t,ShieldedCardCollection:n}}),ABINE_DNTME.define("abine/models/shieldedEmail",["models"],function(e){var t=e.BaseModel.extend({}),n=e.BaseModel.extend({storageEntity:"shieldedEmail",initialize:function(e){this.messenger=e.messenger||this.getMessenger(),this.hasMany({altEmails:{collection:i}})},generateDisposable:function(t,n){return new e.DisposableEmail({targetGuid:this.get("guid"),label:t,source:n})},getAddress:function(){return this.get("email")},isValidated:function(){return 1==this.get("active")},resendValidationEmail:function(e){this.sync("update",this,{eventName:"update:shieldedEmail:resendValidationEmail:"+this.get("id"),success:function(t){e(t)},error:function(t){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/shieldedEmail]#[resendValidationEmail]# error event in model.sync eventName: update:shieldedEmail:resendValidationEmail:id"),e(t)}})}}),r=e.BaseCollection.extend({model:n,interestedBroadcasts:/broadcast:register:success/i}),i=e.BaseCollection.extend({model:t});return e.ShieldedEmail=n,e.ShieldedEmailCollection=r,{ShieldedEmail:n,ShieldedEmailCollection:r}}),ABINE_DNTME.define("abine/models/shieldedPhone",["models","documentcloud/underscore"],function(e){var t=e.BaseModel.extend({storageEntity:"shieldedPhone",generateDisposable:function(){return new e.DisposablePhone({shielded_phone_id:this.get("id")})},hasNumber:function(){return!(!this.has("number")||""==this.get("number"))},registerNumber:function(e){this.sync("create",this,{eventName:"create:shieldedPhone",success:e.success,error:e.error})},verifySecret:function(e){this.sync("update",this,{eventName:"update:shieldedPhone:secret",success:e.success,error:e.error})},getCountryCode:function(){return this.get("country_code")||"1"},getAreaCode:function(){return this.get("number").substr(0,3)},getExchange:function(){return this.get("number").substr(3,3)},getLocal:function(){return this.get("number").substr(6,4)},getPrettyNumber:function(){return this.isNorthAmericaFormat()?"("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal():this.isEuropeanFormat()?"0"+this.get("number"):this.get("number")},getFullPrettyNumber:function(){return this.isNorthAmericaFormat()?"+"+this.getCountryCode()+" ("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal():"+"+this.getCountryCode()+" "+this.get("number")},isNorthAmericaFormat:function(){return"1"==this.getCountryCode()},isEuropeanFormat:function(){var e=this.getCountryCode()[0];return"3"==e||"4"==e},isTextAllowed:function(){return this.getCountryCode()in{1:1,44:1}},isValidated:function(){return"true"==this.get("is_validated")}}),n=e.BaseCollection.extend({model:t});return e.ShieldedPhone=t,e.ShieldedPhoneCollection=n,{ShieldedPhone:t,ShieldedPhoneCollection:n}}),ABINE_DNTME.define("abine/models/tabData",["documentcloud/underscore","models","jquery","abine/intl"],function(e,t,n,r){var i=t.BaseModel.extend({storageEntity:"pageTracker",hasSuggested:function(){return!0}}),a=t.BaseCollection.extend({model:i,getBlocked:function(){for(var e=0,t=0;t<this.length;t++)1==this.at(t).get("blocked")&&e++;return e},getAllowed:function(){for(var e=0,t=0;t<this.length;t++)1!=this.at(t).get("blocked")&&e++;return e}}),o=t.BaseModel.extend({storageEntity:"blacklistOrPreference"}),s=t.BaseModel.extend({storageEntity:"customTabData"}),l=t.BaseCollection.extend({model:s,isFeedbackShown:function(){for(var e=0;e<this.length;e++)if("feedbackShown"==this.at(e).get("name"))return this.at(e).get("value");return!1},changedFeature:function(){for(var e=0;e<this.length;e++)if("changedFeature"==this.at(e).get("name")){var t=this.at(e).get("value");if(""==t)break;var n=this.changedFeatureOffStatus(),i=n?"off":"on";return r.getText("mm_dntme_toggled_"+t+"_"+i)}return null},changedFeatureOffStatus:function(){for(var e=0;e<this.length;e++)if("changedFeatureOffStatus"==this.at(e).get("name"))return this.at(e).get("value");return null},setCustomTabData:function(e,t){for(var n=null,r=0;r<this.length;r++)this.at(r).get("name")==e&&(n=this.at(r));n||(n=new s,this.add(n)),n.save({name:e,value:t})}}),c=t.BaseModel.extend({storageEntity:"tabData",initialize:function(e){this.messenger=e.messenger||this.getMessenger(),this.hasMany({trackers:{collection:a},custom:{collection:l}}),this.hasOne({blacklist:{model:t.Blacklist},dntStats:{model:t.DntStats}})},hasFiveOrMoreTrackers:function(){return this.trackers.length>=5},hasMobileAppAndDropboxEnabled:function(){return this.get("hasMobileApp")&&this.get("dropboxEnabled")&&this.get("entitledToSync")},fetchTrackers:function(e){e=e||{},e.eventName="read:"+this.storageEntity+":trackers",this.fetch(e)}});return t.TabData=c,t.CustomTabData=s,t.BlacklistOrPreference=o,{TabData:c}}),ABINE_DNTME.define("abine/models/pageData",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"pageData"});return t.PageData=n,{PageData:n}}),ABINE_DNTME.define("abine/models/address",["models","documentcloud/underscore"],function(e){var t=e.BaseModel.extend({storageEntity:"address",getFormattedText:function(){var e=[this.get("address1"),this.get("address2"),this.get("city"),this.get("state"),this.get("zip")].join(",");return e=e.replace(/(\s*,\s*)+/g,", ")},toFillData:function(){return this.toJSON()}}),n=e.BaseCollection.extend({model:t,initialize:function(){this.messenger=this.getMessenger()}});return e.Address=t,e.AddressCollection=n,{Address:t,AddressCollection:n}}),ABINE_DNTME.define("abine/models/account",["models","documentcloud/underscore"],function(e){var t=e.BaseModel.extend({storageEntity:"account",getFormattedText:function(){var e=[];return this.get("email")&&e.push("Email: "+this.get("email")),this.get("username")&&e.push("Username: "+this.get("username")),this.get("password")&&e.push("Password: "+this.get("password")),e.join("\n")},getAddress:function(){var e=this.get("label");if(e&&e.length>0&&e!=this.get("domain"))return e;var t=this.get("email");if(t&&t.length>0)return t;var n=this.get("username");if(n&&n.length>0)return n;var r=this.get("password");return r&&r.length>0?"- Only Password -":"- Not set -"},toFillData:function(){return{label:this.getAddress(),email:this.get("email"),username:this.get("username"),password:this.get("password")}}}),n=e.BaseCollection.extend({model:t,initialize:function(){this.messenger=this.getMessenger()},fetchAllByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:account:domain:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/account]#[fetchAllByDomain]# error event in model.sync eventName: read:account:domain:domain")}})},fetchLoginsByDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:logins:domain:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/account]#[fetchAllByDomain]# error event in model.sync eventName: read:account:domain:domain")}})},fetchAccountsByPassword:function(e,t){this.sync("read",this,{eventName:"read:accounts:password:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/account]#[fetchAllByDomain]# error event in model.sync eventName: read:account:domain:domain")}})}});return e.Account=t,e.AccountCollection=n,{Account:t,AccountCollection:n}}),ABINE_DNTME.define("abine/models/identity",["models","documentcloud/underscore","abine/intl","abine/assets"],function(e){var t=e.BaseModel.extend({storageEntity:"identity",getLabel:function(){var e=this.get("label");return e&&e.length>15&&(e=e.substr(0,12)+"..."),e},toFillData:function(){var e=this.toJSON();return e.full_name=(this.get("first_name")+" "+this.get("last_name")).replace(/^[\s]+|[\s]+$/g,"").replace(/[\s]+$/g," "),e.email&&e.email.indexOf("@")!=-1&&(e.real_email=e.email),e}}),n=e.BaseCollection.extend({model:t,initialize:function(){this.messenger=this.getMessenger()}});return e.Identity=t,e.IdentityCollection=n,{Identity:t,IdentityCollection:n}}),ABINE_DNTME.define("abine/models/realCard",["models","documentcloud/underscore","abine/intl","abine/assets"],function(e,t,n,r){var i=e.BaseModel.extend({storageEntity:"realCard",getLastFour:function(){return this.get("number").substr(this.get("number").length-4)},getNonDefaultLabel:function(){var e=this.get("label");return e&&e.toLowerCase()==(this.getType()+" "+this.getLastFour()).toLowerCase()?null:e},labelChangeRequired:function(){var e=this.get("label");return!(!e||!(e.length>15||e.toLowerCase()==(this.getType()+" "+this.getLastFour()).toLowerCase()))},getLabelOrLastFour:function(){if(this.getNonDefaultLabel())return n.getText("mm_payment_helper_useCardName",[this.getLabel()]);var e=this.getDisplayType();return e?n.getText("mm_payment_helper_useCardName",[e+"-"+this.getLastFour()]):n.getText("mm_payment_helper_useCardName",["x"+this.getLastFour()])},getCardNumber:function(){return this.get("number")},getSeparatedCardNumber:function(){var e=this.get("number");return 16==e.length?e.substring(0,4)+" "+e.substring(4,8)+" "+e.substring(8,12)+" "+e.substring(12,16):this.get("type")&&this.get("type").match(/amex|american/i)?e.substr(0,4)+" "+e.substr(4,6)+" "+e.substr(10):e},getSeparatedMaskedCardNumber:function(){var e=this.get("number");if(16==e.length)return Array(4).join("**** ")+e.substring(12,16);var t=this.get("type");return t&&t.match(/amex|american/i)?"**** ****** *"+e.substr(-4):Array(e.length-3).join("*")+e.substr(-4)},getMaskedVerification:function(){return Array(this.get("cvc").length+1).join("*")},getMaskedExpiry:function(){return this.getExpiry().replace(/[0-9]/g,"*")},getBrandImage:function(){var e=this.getBrand();return e&&e.match(/asd/)||(e="no_match"),r.assetUrl("/pages/images/blank_cards/"+e+".png")},getTypeImage:function(){var e=this.getType();return e.match(/american_express|diners_club|discover|jcb|laser|maestro|mastercard|visa/)||(e="no_match"),r.assetUrl("/pages/images/credit_cards/"+e+".png")},getAddress:function(){var e=this.get("address");if(!e)return null;var t=[e.address1,e.address2,e.city,e.state,e.zip].join(",");return t=t.replace(/(\s*,\s*)+/g,", ")},getFormattedText:function(){var e=[this.get("first_name")+" "+this.get("last_name"),this.getPrettyNumber(),"Exp: "+this.getExpiry()+" CVC: "+this.getCVC(),this.getAddress()].join("\n");return e=e.replace(/[\n]+/g,"\n")},getAddress1:function(){var e=this.get("address");return e?e.address1.replace(/(\s*,\s*)+/g,", "):null},getAddress2:function(){var e=this.get("address");return e?e.address2.replace(/(\s*,\s*)+/g,", "):null},getCityState:function(){var e=this.get("address");if(!e)return null;var t=[e.city,e.state].join(",");return t=t.replace(/(\s*,\s*)+/g,", ")},getPostal:function(){var e=this.get("address");return e?e.zip.replace(/(\s*,\s*)+/g,", "):null},getType:function(){return this.get("type").toLowerCase()},getDisplayType:function(){var e=this.getType();return e.match(/visa/)?"Visa":e.match(/master/)?"Master":e.match(/amex|american/)?"Amex":e.match(/diner/)?"Diners":e.match(/discover/)?"Discover":e.match(/jcb/)?"Jcb":e.match(/laser/)?"Lazer":e.match(/maestro/)?"Maestro":null},getBrand:function(){return this.get("brand").toLowerCase()},getPrettyNumber:function(){for(var e="",t=0;t<this.get("number").length;t++)e+=this.get("number").charAt(t),t%4==3&&(e+="  ");return e},getCVC:function(){return this.get("cvc")},getExpiry:function(){var e=parseInt(this.get("expiry_month"));return e<10&&(e="0"+e),e+"/"+this.get("expiry_year")},getLabel:function(){var e=this.get("label");return e&&e.length>15&&(e=e.substr(0,12)+"..."),e},getProtectedNumber:function(){var e=this.get("number")+"";return e.substr(0,e.length-12).replace(/./g,"x")+e.substr(e.length-4)},getProtectedVerification:function(){var e=this.get("verification")+"";return e.substr(0,e.length-1).replace(/./g,"x")+e.substr(e.length-1)},isRealCard:function(){return"real_card"==this.get("cardType")},isOfferCard:function(){return"offer"==this.get("cardType")},isNewMaskedCard:function(){return"new_masked_card"==this.get("cardType")},isNewRealCard:function(){return"new_real_card"==this.get("cardType")},toFillData:function(){var e=this.toJSON(),t=e.number;return e.last_4=t.substr(t.length-4),16==t.length?(e.first_4=t.substring(0,4),e.second_4=t.substring(4,8),e.third_4=t.substring(8,12)):e.type&&e.type.match(/ame/i)&&(e.amex_4=t.substring(0,4),e.amex_6=t.substring(4,10),e.amex_5=t.substring(10,15)),e.expiry_year&&e.expiry_month&&(e.expiry=e.expiry_month+"/"+e.expiry_year,e.expiry2=e.expiry_month+"/"+e.expiry_year.substring(2)),e.expiry_year&&(e.expiry_year2=e.expiry_year.substring(2)),e.full_name=(e.first_name+" "+e.last_name).replace(/^[\s]+|[\s]+$/g,"").replace(/[\s]+$/g," "),null!=this.get("address")&&(e.address=this.get("address")),e}}),a=e.BaseCollection.extend({model:i,initialize:function(){this.messenger=this.getMessenger()},fetchOfferCardsForDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:realCard:offers:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/realCard]#[fetchAllForDomain]# error event in read:realCard:offers:domain"),t(!0)}})},fetchAllForDomain:function(e,t){e&&(e=e.replace(":","::")),this.sync("read",this,{eventName:"read:realCard:site:"+e,success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/realCard]#[fetchAllForDomain]# error event in read:realCard:site:domain"),t(!0)}})}});return e.RealCard=i,e.RealCardCollection=a,{RealCard:i,RealCardCollection:a}}),ABINE_DNTME.define("abine/models/globalData",["documentcloud/underscore","models","jquery","abine/intl"],function(e,t,n,r){var i=t.BaseModel.extend({storageEntity:"globalTracker",hasSuggested:function(){return!1}}),a=t.BaseCollection.extend({model:i}),o=t.BaseModel.extend({storageEntity:"globalPreference",getLabel:function(){return r.getText("mm_dntme_"+this.get("name").toLowerCase())},getId:function(){return this.get("name").toLowerCase()},getTooltip:function(){return r.getText("mm_dntme_help_"+this.get("name").toLowerCase())}}),s=t.BaseCollection.extend({model:o}),l=t.BaseModel.extend({storageEntity:"globalFeature",getLabel:function(){var e=this.get("name");switch(e){case"suggestStrongPassword":return r.getText("mm_dntme_accounts_password");case"suggestAddresses":return r.getText("mm_dntme_wallet_address");case"suggestRealCard":return r.getText("mm_dntme_wallet_real_card");case"rememberCards":return r.getText("mm_dntme_wallet_save_card");case"suggestIdentities":return r.getText("mm_dntme_wallet_identity");case"browsing":return r.getText("mm_dntme_tracking_blocker");case"email":return r.getText("mm_dntme_masking_email");case"phone":return r.getText("mm_dntme_masking_phone");case"card":return r.getText("mm_dntme_masking_card");case"search":return r.getText("mm_dntme_masking_search");case"helpMeLogin":return r.getText("mm_dntme_accounts_help_login");case"submitAccount":return r.getText("mm_dntme_accounts_submit_account");case"rememberAccounts":return r.getText("mm_dntme_accounts_save_account");
case"showCheckoutPanelGrowl":return r.getText("mm_dntme_showcheckoutpanelgrowl")}},isBrowsing:function(){return"browsing"==this.get("name")},getTooltip:function(){var e=this.get("value")?"off":"on";return this.isBrowsing()?r.getText("mm_dntme_help_what_will_happen_"+e+"_"+this.get("name").toLowerCase(),"all sites"):r.getText("mm_dntme_help_what_will_happen_"+e+"_"+this.get("name").toLowerCase())}}),c=t.BaseCollection.extend({model:l}),u=t.BaseModel.extend({storageEntity:"globalData",initialize:function(e){this.messenger=e.messenger||this.getMessenger(),this.hasMany({trackers:{collection:a},preferences:{collection:s},globalFeatures:{collection:c},blacklist:{collection:t.BlacklistCollection}})}});return t.GlobalData=u,{GlobalData:u}}),ABINE_DNTME.define("abine/models/feedback",["documentcloud/underscore","documentcloud/backbone","models"],function(e,t,n){var r=n.BaseModel.extend({initialize:function(){},getSuccessLeadMsg:function(){return this.attributes.leadMsg},getSuccessMsg:function(){return this.attributes.successMsg},clone:function(){var e=new this.constructor(this);return e.user=this.user,e}});return n.Feedback=r,{Feedback:r}}),ABINE_DNTME.define("abine/models/trackerInfo",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"trackerInfo",initialize:function(){this.messenger=this.getMessenger()}}),r=t.BaseCollection.extend({model:n,fetchAllForDomains:function(e,t){this.sync("read",this,{eventName:"read:trackerInfo:index",payload:{domains:e},success:function(e){this.reset(e),t()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/disposableEmail]#[fetchAllByDomain]# error event in model.sync eventName: read:disposableEmail:domain:domain")}})}});return t.TrackerInfo=n,t.TrackerInfoCollection=r,{TrackerInfo:n,TrackerInfoCollection:r}}),ABINE_DNTME.define("abine/models/advt",["documentcloud/underscore","models"],function(e,t){var n=t.BaseModel.extend({storageEntity:"advt",initialize:function(){this.messenger=this.getMessenger()}}),r=t.BaseCollection.extend({model:n,fetchAllForQuery:function(e,t,n){this.sync("read",this,{eventName:"read:advt:index",payload:{query:e,url:t},success:function(e){this.reset(e),n()},error:function(){ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/models/advt]#[fetchAllByQuery]# error event in model.sync eventName: read:advt:index")}})}});return t.Advt=n,t.AdvtCollection=r,{Advt:n,AdvtCollection:r}});